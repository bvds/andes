(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    117112,       2910]
NotebookOptionsPosition[    111754,       2738]
NotebookOutlinePosition[    112243,       2757]
CellTagsIndexPosition[    112200,       2754]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["\<\
For use in git:  Format -> Option Inspector -> Notebook Options -> \
PrivateNotebookOptions -> \[OpenCurlyDoubleQuote]FileOutlineCache\
\[CloseCurlyDoubleQuote] set to False.\
\>", "Text",
 CellChangeTimes->{{3.673292108059205*^9, 3.673292200629389*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  RowBox[{"NotebookDirectory", "[", "]"}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.544401989256278*^9, 3.544402015850553*^9}}],

Cell[BoxData["\<\"/Users/uvandbr/andes/LogProcessing/moment-of-learning\"\>"],\
 "Output",
 CellChangeTimes->{3.545415442781939*^9, 3.546131563162306*^9, 
  3.55544133519975*^9, 3.556333602676476*^9, 3.556742374150465*^9, 
  3.556968213301572*^9, 3.566589650591445*^9, 3.566590426624051*^9, 
  3.566591658840971*^9, 3.5757495125693913`*^9, 3.695660174972497*^9, 
  3.695730360804474*^9, 3.695736283793034*^9, 3.699379688433936*^9, 
  3.6996184270461063`*^9, 3.699791713336905*^9, 3.699795052802232*^9, 
  3.699803256429294*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"journalStyle", "=", 
   RowBox[{"{", 
    RowBox[{"FontSize", "\[Rule]", "9"}], " ", 
    RowBox[{"(*", " ", 
     RowBox[{"ACM", " ", "default", " ", "font", " ", "for", " ", "text", " ", 
      RowBox[{"(", 
       RowBox[{
       "10", " ", "for", " ", "large", " ", "journal", " ", "format"}], 
       ")"}]}], " ", "*)"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"figureWidth", "=", 
   RowBox[{"72", " ", 
    RowBox[{"If", "[", 
     RowBox[{"False", ",", "6.5", " ", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Maximum", " ", "allowed", " ", "width", " ", "for", " ", "ACM", " ", 
        "journal", " ", "large", " ", 
        RowBox[{"format", "."}]}], " ", "*)"}], ",", "\[IndentingNewLine]", 
      "\t", 
      RowBox[{"10", "/", "3"}]}], " ", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "ACM", " ", "journal", " ", "column", " ", "with", " ", "for", " ", 
        "two"}], "-", 
       RowBox[{"column", " ", 
        RowBox[{"format", "."}]}]}], " ", "*)"}], "]"}]}]}], ";"}]}], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.5567387399792356`*^9, 3.556738785657119*^9}, {
  3.559926012120932*^9, 3.559926089440562*^9}, {3.559926325780661*^9, 
  3.559926326691791*^9}, {3.559926615085618*^9, 3.559926615829599*^9}, {
  3.559926675150295*^9, 3.559926676236656*^9}, {3.55992673961215*^9, 
  3.559926765300554*^9}, {3.5706711270365*^9, 3.570671194156896*^9}, {
  3.5706719564022293`*^9, 3.570671961737838*^9}, {3.570672151946643*^9, 
  3.570672170506446*^9}}],

Cell[CellGroupData[{

Cell["BKT Markov chain model", "Subsection",
 CellChangeTimes->{{3.545414161968773*^9, 3.54541416788512*^9}, {
  3.545414264056784*^9, 3.545414269270051*^9}, {3.555866295346248*^9, 
  3.555866303337057*^9}, {3.5558941707712927`*^9, 3.555894178041609*^9}, {
  3.555894221731432*^9, 3.555894227183649*^9}, {3.6993802391593018`*^9, 
  3.699380257381918*^9}}],

Cell[BoxData[
 RowBox[{"bktPlot", "=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"b", "=", "0.3"}], ",", 
      RowBox[{"pg", "=", ".15"}], ",", 
      RowBox[{"ps", "=", "0.2"}], ",", 
      RowBox[{"nn", "=", "11"}]}], "}"}], ",", 
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{"1", "-", "ps", "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "pg", "-", "ps"}], ")"}], "  ", 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", "b"}], " ", "x"}], "]"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "0", ",", "nn"}], "}"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}], ",", 
      RowBox[{"AxesLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\"\<\!\(\*
StyleBox[\"j\",
FontSlant->\"Italic\"]\)\>\"", ",", 
         RowBox[{"SequenceForm", "[", 
          RowBox[{"\"\<\!\(\*
StyleBox[\"P\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\"(\",
FontSlant->\"Italic\"]\)\>\"", ",", 
           RowBox[{"Subscript", "[", 
            RowBox[{"\"\<C\>\"", ",", "\"\<\!\(\*
StyleBox[\"j\",
FontSlant->\"Italic\"]\)\>\""}], "]"}], ",", "\"\<)\>\""}], "]"}]}], "}"}]}], 
      ",", 
      RowBox[{"BaseStyle", "\[Rule]", "journalStyle"}], ",", " ", 
      RowBox[{"AspectRatio", "\[Rule]", 
       RowBox[{"1", "/", "2"}]}], ",", 
      RowBox[{"Epilog", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Text", "[", 
          RowBox[{"\"\<1-\!\(\*
StyleBox[\"P\",
FontSlant->\"Italic\"]\)(S)-\!\(\*
StyleBox[\"A\",
FontSlant->\"Italic\"]\)\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "pg"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"Text", "[", 
          RowBox[{"\"\<1-\!\(\*
StyleBox[\"P\",
FontSlant->\"Italic\"]\)(S)\>\"", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"nn", "-", "2"}], ",", 
             RowBox[{"1", "-", "ps"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", "Dashed", ",", 
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "pg"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"4", ",", "pg"}], "}"}]}], "}"}], "]"}], ",", 
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"nn", "-", "4"}], ",", 
              RowBox[{"1", "-", "ps"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"nn", ",", 
              RowBox[{"1", "-", "ps"}]}], "}"}]}], "}"}], "]"}]}], "}"}]}]}], 
     "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.545414281648155*^9, 3.545414378524003*^9}, {
   3.545414414740333*^9, 3.545414487262527*^9}, {3.54541451819056*^9, 
   3.545414554747292*^9}, {3.545414679494235*^9, 3.545414786153323*^9}, {
   3.545414903481468*^9, 3.545414936399742*^9}, {3.54541497063005*^9, 
   3.545415092618459*^9}, 3.54541515331998*^9, {3.545415192437534*^9, 
   3.545415193979922*^9}, {3.545415309414765*^9, 3.545415312821149*^9}, {
   3.545440558549473*^9, 3.545440577658638*^9}, {3.54544225541938*^9, 
   3.545442268691428*^9}, {3.545442476491322*^9, 3.545442490716555*^9}, {
   3.545442538816387*^9, 3.545442539835766*^9}, {3.552180336924226*^9, 
   3.552180701960452*^9}, {3.552180737062706*^9, 3.5521808187432213`*^9}, {
   3.55218085126927*^9, 3.552180870095912*^9}, {3.552181336334396*^9, 
   3.552181416802292*^9}, {3.5554411588731422`*^9, 3.555441163628972*^9}, {
   3.556326139442256*^9, 3.556326185857656*^9}, {3.556738687342217*^9, 
   3.556738701981556*^9}, {3.556738830441554*^9, 3.5567388421231956`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{"\"\<exponential.eps\>\"", ",", "bktPlot", ",", 
   RowBox[{"ImageSize", "\[Rule]", 
    RowBox[{"figureWidth", " ", 
     RowBox[{"2", "/", "3"}]}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.545415315763898*^9, 3.545415353126089*^9}, {
   3.552181423625525*^9, 3.5521814522066727`*^9}, 3.566591606034321*^9}],

Cell[BoxData["\<\"exponential.eps\"\>"], "Output",
 CellChangeTimes->{{3.552181429375592*^9, 3.552181454984557*^9}, 
   3.5554412334594107`*^9, 3.5554413411321774`*^9, 3.556326226742194*^9, 
   3.5563336095884*^9, 3.556738719157434*^9, {3.556738847926345*^9, 
   3.5567388859572277`*^9}, 3.556742381604663*^9, 3.566591607973002*^9, 
   3.56659166501716*^9}]
}, Open  ]],

Cell["Values for A to match Table 1 in Beck and Chang paper.", "Text",
 CellChangeTimes->{{3.5659708463919687`*^9, 3.565970878445093*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "-", "ps", "-", "pg"}], ")"}], 
   RowBox[{"(", 
    RowBox[{"1", "-", "p0"}], ")"}]}], "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"ps", "\[Rule]", "0.05"}], ",", 
    RowBox[{"pg", "\[Rule]", "0.3"}], ",", 
    RowBox[{"p0", "\[Rule]", "0.36"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.5659706259729156`*^9, 3.565970638253005*^9}, {
  3.565970710635569*^9, 3.565970756333826*^9}, {3.565970793550983*^9, 
  3.5659708014775753`*^9}}],

Cell[BoxData["0.4159999999999999`"], "Output",
 CellChangeTimes->{3.5659707703799887`*^9, 3.5659708037928867`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"table1", "=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"aa", "=", ".418"}], ",", 
      RowBox[{"ps", "=", "0.05"}], ",", 
      RowBox[{"bd", "=", "0.15"}]}], "}"}], ",", 
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{"1", "-", 
       RowBox[{"aa", "/", 
        RowBox[{"(", 
         RowBox[{"1", "-", "pg", "-", "ps"}], ")"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"pg", ",", 
        RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "bd"}], ",", 
           RowBox[{"1", "+", "bd"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "bd"}], ",", 
           RowBox[{"1", "+", "bd"}]}], "}"}]}], "}"}]}], ",", 
      RowBox[{"AxesLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\"\<\!\(\*
StyleBox[\"P\",
FontSlant->\"Italic\"]\)(G)\>\"", ",", 
         RowBox[{"SequenceForm", "[", 
          RowBox[{"\"\<\!\(\*
StyleBox[\"P\",
FontSlant->\"Italic\"]\)(\>\"", ",", 
           RowBox[{"Subscript", "[", 
            RowBox[{"\"\<\!\(\*
StyleBox[\"L\",
FontSlant->\"Italic\"]\)\>\"", ",", "\"\<0\>\""}], "]"}], ",", "\"\<)\>\""}], 
          "]"}]}], "}"}]}], ",", 
      RowBox[{"BaseStyle", "\[Rule]", "journalStyle"}], ",", " ", 
      RowBox[{"Epilog", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Text", "[", 
          RowBox[{"\"\<1-P(S)\>\"", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"1", "-", "ps"}], ",", 
             RowBox[{"1", "/", "2"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], "]"}], ",", 
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"1", "-", "ps"}], ",", 
              RowBox[{"-", "1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"1", "-", "ps"}], ",", "2"}], "}"}]}], "}"}], "]"}], 
         ",", 
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", "1"}], "}"}]}], "}"}], "]"}], ",", 
         RowBox[{"PointSize", "[", "Medium", "]"}], ",", 
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{".3", ",", ".36"}], "}"}], "]"}], ",", 
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", ".56"}], "}"}], "]"}], ",", 
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"0.53", ",", "0.01"}], "}"}], "]"}]}], "}"}]}]}], "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.545414281648155*^9, 3.545414378524003*^9}, {
   3.545414414740333*^9, 3.545414487262527*^9}, {3.54541451819056*^9, 
   3.545414554747292*^9}, {3.545414679494235*^9, 3.545414786153323*^9}, {
   3.545414903481468*^9, 3.545414936399742*^9}, {3.54541497063005*^9, 
   3.545415092618459*^9}, 3.54541515331998*^9, {3.545415192437534*^9, 
   3.545415193979922*^9}, {3.545415309414765*^9, 3.545415312821149*^9}, {
   3.545440558549473*^9, 3.545440577658638*^9}, {3.54544225541938*^9, 
   3.545442268691428*^9}, {3.545442476491322*^9, 3.545442490716555*^9}, {
   3.545442538816387*^9, 3.545442539835766*^9}, {3.552180336924226*^9, 
   3.552180701960452*^9}, {3.552180737062706*^9, 3.5521808187432213`*^9}, {
   3.55218085126927*^9, 3.552180870095912*^9}, {3.552181336334396*^9, 
   3.552181416802292*^9}, {3.5554411588731422`*^9, 3.555441163628972*^9}, {
   3.555888974410527*^9, 3.5558890062347918`*^9}, {3.555889118744714*^9, 
   3.555889143076107*^9}, {3.555890897498996*^9, 3.55589093549728*^9}, {
   3.555890977247829*^9, 3.555891029330106*^9}, {3.5558910643748713`*^9, 
   3.5558911109539003`*^9}, {3.5558911474612427`*^9, 3.555891186212613*^9}, {
   3.55589121878542*^9, 3.555891255950932*^9}, {3.555893832413972*^9, 
   3.5558938436639137`*^9}, {3.555893881117626*^9, 3.5558938840991583`*^9}, {
   3.555893915279396*^9, 3.555893990714507*^9}, {3.555894022711494*^9, 
   3.555894052926488*^9}, 3.555894087738801*^9, {3.556552303450169*^9, 
   3.556552357920786*^9}, {3.556738726542219*^9, 3.556738732517806*^9}, 
   3.5567388691129017`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{"\"\<table1.eps\>\"", ",", "table1", ",", 
   RowBox[{"ImageSize", "\[Rule]", 
    RowBox[{"figureWidth", " ", 
     RowBox[{"2", "/", "3"}]}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.545415315763898*^9, 3.545415353126089*^9}, {
   3.552181423625525*^9, 3.5521814522066727`*^9}, {3.555888981321795*^9, 
   3.5558889947612877`*^9}, 3.56659158888941*^9}],

Cell[BoxData["\<\"table1.eps\"\>"], "Output",
 CellChangeTimes->{{3.552181429375592*^9, 3.552181454984557*^9}, 
   3.5554412334594107`*^9, 3.5554413411321774`*^9, 3.555894116023306*^9, 
   3.556552369267394*^9, {3.5567388734352713`*^9, 3.5567388904983892`*^9}, 
   3.5567423868870373`*^9, 3.566591594980213*^9, 3.566591673573015*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["BKT hidden Markov model recursion", "Subsection",
 CellChangeTimes->{{3.545414161968773*^9, 3.54541416788512*^9}, {
  3.545414264056784*^9, 3.545414269270051*^9}, {3.555866295346248*^9, 
  3.555866303337057*^9}, {3.699380356593605*^9, 3.699380370208446*^9}}],

Cell["Values from Table 1, \"Guess model\" of Beck and Chang paper.", "Text",
 CellChangeTimes->{{3.555866458586188*^9, 3.555866482520188*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"vals", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ps", "->", "0.05"}], ",", " ", 
     RowBox[{"pg", "->", "0.3"}], ",", " ", 
     RowBox[{"pl", "->", "0.1"}], ",", " ", 
     RowBox[{"p0", "->", "0.36"}]}], "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.55586640083585*^9, 3.555866454097419*^9}, {
   3.55586696781595*^9, 3.555866994575345*^9}, {3.555867055590937*^9, 
   3.555867056815066*^9}, 3.555955469386262*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"recursion", "[", 
    RowBox[{"\"\<correct\>\"", ",", "plast_"}], "]"}], ":=", 
   RowBox[{"1", "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "pl"}], ")"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", "plast"}], ")"}], " ", 
     RowBox[{"pg", "/", 
      RowBox[{"(", 
       RowBox[{"pg", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "ps", "-", "pg"}], ")"}], " ", "plast"}]}], 
       ")"}]}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"recursion", "[", 
    RowBox[{"\"\<incorrect\>\"", ",", "plast_"}], "]"}], ":=", 
   RowBox[{"1", "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "pl"}], ")"}], 
     RowBox[{"(", 
      RowBox[{"1", "-", "plast"}], ")"}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "pg"}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"1", "-", "pg", "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "ps", "-", "pg"}], ")"}], " ", "plast"}]}], 
       ")"}]}]}]}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.555866494775902*^9, 3.555866648906721*^9}, {
  3.555866998948783*^9, 3.555867010555528*^9}, {3.555867158938841*^9, 
  3.555867162897966*^9}, {3.555872385710925*^9, 3.555872393943768*^9}, {
  3.555955472816178*^9, 3.55595547393697*^9}}],

Cell["Find fixed points of the recursion", "Text",
 CellChangeTimes->{{3.555870039621642*^9, 3.55587004971469*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fcorrect", "=", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"recursion", "[", 
      RowBox[{"\"\<correct\>\"", ",", "plast"}], "]"}], "\[Equal]", "plast"}],
     ",", "plast"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.555867084066691*^9, 3.555867110165866*^9}, {
  3.555867235298462*^9, 3.555867241938392*^9}, {3.555868400276856*^9, 
  3.555868406692386*^9}, {3.555872396993584*^9, 3.555872399528806*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"plast", "\[Rule]", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"plast", "\[Rule]", 
     FractionBox[
      RowBox[{"pg", " ", "pl"}], 
      RowBox[{
       RowBox[{"-", "1"}], "+", "pg", "+", "ps"}]]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.555955510343444*^9, 3.556550790064958*^9, 
  3.556738706828784*^9, 3.556742373631371*^9, 3.556933236032769*^9, 
  3.556968212802054*^9, 3.5659707702465363`*^9, 3.5665894599544573`*^9, 
  3.566590426444669*^9, 3.575740216103059*^9, 3.695660175105999*^9, 
  3.695730360888528*^9, 3.695736283926906*^9, 3.699379688550004*^9, 
  3.6996184271825666`*^9, 3.699791713538692*^9, 3.6997950528848*^9, 
  3.699803256541319*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fcorrect", "/.", "vals"}]], "Input",
 CellChangeTimes->{{3.555867244505467*^9, 3.555867247864984*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"plast", "\[Rule]", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"plast", "\[Rule]", 
     RowBox[{"-", "0.04615384615384616`"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.555867248967173*^9, 3.555872403715175*^9, 
  3.555955517781647*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fincorrect", "=", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"recursion", "[", 
      RowBox[{"\"\<incorrect\>\"", ",", "plast"}], "]"}], "\[Equal]", 
     "plast"}], ",", "plast"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.555867084066691*^9, 3.555867110165866*^9}, {
  3.555867201619501*^9, 3.555867201875173*^9}, {3.555867263163055*^9, 
  3.555867267939314*^9}, {3.555872407817191*^9, 3.555872410488326*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"plast", "\[Rule]", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"plast", "\[Rule]", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "pl"}], "+", 
       RowBox[{"pg", " ", "pl"}]}], 
      RowBox[{
       RowBox[{"-", "1"}], "+", "pg", "+", "ps"}]]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.555955519718174*^9, 3.556550791066431*^9, 
  3.5567387069137087`*^9, 3.556742373707353*^9, 3.556933236147583*^9, 
  3.556968212980101*^9, 3.5659707702812147`*^9, 3.5665894599815397`*^9, 
  3.566590426540856*^9, 3.575740216147944*^9, 3.695660175134967*^9, 
  3.6957303609052753`*^9, 3.6957362840234423`*^9, 3.699379688566134*^9, 
  3.699618427217474*^9, 3.699791713570621*^9, 3.6997950529031153`*^9, 
  3.699803256574628*^9}]
}, Open  ]],

Cell["Expansion about fixed points", "Text",
 CellChangeTimes->{{3.555868314229748*^9, 3.555868324019153*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"Series", "[", 
   RowBox[{
    RowBox[{"recursion", "[", 
     RowBox[{"\"\<correct\>\"", ",", "plast"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"plast", ",", "1", ",", "1"}], "}"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.555868327365114*^9, 3.555868359900812*^9}, {
  3.555868417124589*^9, 3.555868475235176*^9}, {3.555872423888866*^9, 
  3.555872428216389*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"1", "+", 
   FractionBox[
    RowBox[{"pg", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "pl"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"plast", "-", "1"}], ")"}]}], 
    RowBox[{
     RowBox[{"-", "1"}], "+", "ps"}]], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", 
      RowBox[{"plast", "-", "1"}], "]"}], "2"],
    SeriesData[$CellContext`plast, 1, {}, 0, 2, 1],
    Editable->False]}],
  SeriesData[$CellContext`plast, 1, {
   1, $CellContext`pg ((-1 + $CellContext`pl)/(-1 + $CellContext`ps))}, 0, 2, 
   1],
  Editable->False]], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{
  3.555868361010044*^9, {3.555868419335893*^9, 3.55586847623454*^9}, 
   3.555872429272858*^9, {3.555955500130344*^9, 3.555955525912848*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"Series", "[", 
   RowBox[{
    RowBox[{"recursion", "[", 
     RowBox[{"\"\<incorrect\>\"", ",", "plast"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"plast", ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "pg"}], ")"}], " ", 
       RowBox[{"pt", "/", 
        RowBox[{"(", 
         RowBox[{"1", "-", "pg", "-", "ps"}], ")"}]}]}], ",", "1"}], "}"}]}], 
   "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.555868327365114*^9, 3.555868359900812*^9}, {
  3.555868417124589*^9, 3.555868551291723*^9}, {3.555868588963247*^9, 
  3.555868615738527*^9}, {3.555872432231235*^9, 3.555872434658901*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"ps", " ", "pt"}], "-", 
     RowBox[{"pl", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "pg", "+", "ps", "+", "pt", "-", 
        RowBox[{"pg", " ", "pt"}]}], ")"}]}]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "pg", "+", "ps"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "pt"}], ")"}]}]], "+", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "pl"}], ")"}], " ", "ps", " ", 
     RowBox[{"(", 
      RowBox[{"plast", "-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "pg"}], ")"}], " ", "pt"}], 
        RowBox[{
         RowBox[{"-", "1"}], "+", "pg", "+", "ps"}]]}], ")"}]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "pg"}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "pt"}], ")"}], "2"]}]], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", 
      RowBox[{"plast", "-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "pg"}], ")"}], " ", "pt"}], 
        RowBox[{
         RowBox[{"-", "1"}], "+", "pg", "+", "ps"}]]}], "]"}], "2"],
    SeriesData[$CellContext`plast, ((-1 + $CellContext`pg)/(-1 + \
$CellContext`pg + $CellContext`ps)) $CellContext`pt, {}, 0, 2, 1],
    Editable->False]}],
  SeriesData[$CellContext`plast, ((-1 + $CellContext`pg)/(-1 + \
$CellContext`pg + $CellContext`ps)) $CellContext`pt, {((-1 + $CellContext`pg + \
$CellContext`ps)^(-1)/(-1 + $CellContext`pt)) ($CellContext`ps \
$CellContext`pt - $CellContext`pl (-1 + $CellContext`pg + $CellContext`ps + \
$CellContext`pt - $CellContext`pg $CellContext`pt)), (((-1 + \
$CellContext`pg)^(-1) (-1 + $CellContext`pl)) $CellContext`ps) (-1 + \
$CellContext`pt)^(-2)}, 0, 2, 1],
  Editable->False]], "Output",
 CellChangeTimes->{{3.55586851448018*^9, 3.55586855248687*^9}, {
   3.555868593053037*^9, 3.555868616707177*^9}, 3.555872435808867*^9, 
   3.555955532233705*^9}]
}, Open  ]],

Cell[TextData[{
 "If we confine our attention to the region 0<P_",
 StyleBox["j",
  FontSlant->"Italic"],
 "<1, the \[OpenCurlyDoubleQuote]",
 StyleBox["j ",
  FontSlant->"Italic"],
 "correct\[CloseCurlyDoubleQuote] recursion relation has a stable fixed point \
at 1.  Near that point, convergence is exponentially fast.  Similarly, the \
\[OpenCurlyDoubleQuote]",
 StyleBox["j",
  FontSlant->"Italic"],
 " incorrect\[CloseCurlyDoubleQuote] recursion relation has a stable fixed \
point at (1-",
 StyleBox["P",
  FontSlant->"Italic"],
 "(G)) ",
 StyleBox["P",
  FontSlant->"Italic"],
 "(T)/(1-",
 StyleBox["P",
  FontSlant->"Italic"],
 "(G)-",
 StyleBox["P",
  FontSlant->"Italic"],
 "(S)).  Near that point, convergence is also exponentially fast."
}], "Text",
 CellChangeTimes->{{3.555873344363937*^9, 3.555873627568571*^9}}],

Cell[BoxData[
 RowBox[{"pRecursion", "=", 
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"plast", ",", 
      RowBox[{
       RowBox[{"recursion", "[", 
        RowBox[{"\"\<correct\>\"", ",", "plast"}], "]"}], "/.", "vals"}], ",", 
      RowBox[{
       RowBox[{"recursion", "[", 
        RowBox[{"\"\<incorrect\>\"", ",", "plast"}], "]"}], "/.", "vals"}]}], 
     "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"plast", ",", 
      RowBox[{"-", "0.01"}], ",", "1.01"}], "}"}], ",", 
    RowBox[{"Epilog", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"PointSize", "[", "Large", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"Red", ",", 
         RowBox[{"Point", "[", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], "]"}], ",", 
         RowBox[{"Text", "[", 
          RowBox[{"\"\<step \!\(\*
StyleBox[\"j\",
FontSlant->\"Italic\"]\) correct\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"0.5", ",", ".8"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Blue", ",", 
         RowBox[{"Point", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", "1"}], "}"}], " ", "plast"}], "/.", 
            RowBox[{"fincorrect", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "/.", "vals"}], "]"}], ",", 
         RowBox[{"Text", "[", 
          RowBox[{"\"\<step \!\(\*
StyleBox[\"j\",
FontSlant->\"Italic\"]\) incorrect\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"0.8", ",", ".3"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"Dashed", ",", "Red", ",", "Blue"}], "}"}]}], ",", 
    RowBox[{"AxesLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"SequenceForm", "[", 
        RowBox[{"\"\<\!\(\*
StyleBox[\"P\",
FontSlant->\"Italic\"]\)(\>\"", ",", 
         RowBox[{"Subscript", "[", 
          RowBox[{"\"\<\!\(\*
StyleBox[\"L\",
FontSlant->\"Italic\"]\)\>\"", ",", "\"\<\!\(\*
StyleBox[\"j\",
FontSlant->\"Italic\"]\)-1\>\""}], "]"}], ",", "\"\<|\>\"", ",", 
         RowBox[{"Subscript", "[", 
          RowBox[{"\"\<\!\(\*
StyleBox[\"O\",
FontSlant->\"Italic\"]\)\>\"", ",", "\"\<\!\(\*
StyleBox[\"j\",
FontSlant->\"Italic\"]\)-1\>\""}], "]"}], ",", "\"\<)\>\""}], "]"}], ",", 
       RowBox[{"SequenceForm", "[", 
        RowBox[{"\"\<\!\(\*
StyleBox[\"P\",
FontSlant->\"Italic\"]\)(\>\"", ",", 
         RowBox[{"Subscript", "[", 
          RowBox[{"\"\<\!\(\*
StyleBox[\"L\",
FontSlant->\"Italic\"]\)\>\"", ",", "\"\<\!\(\*
StyleBox[\"j\",
FontSlant->\"Italic\"]\)\>\""}], "]"}], ",", "\"\<|\>\"", ",", 
         RowBox[{"Subscript", "[", 
          RowBox[{"\"\<\!\(\*
StyleBox[\"O\",
FontSlant->\"Italic\"]\)\>\"", ",", "\"\<\!\(\*
StyleBox[\"j\",
FontSlant->\"Italic\"]\)\>\""}], "]"}], ",", "\"\<)\>\""}], "]"}]}], "}"}]}], 
    ",", 
    RowBox[{"BaseStyle", "\[Rule]", "journalStyle"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.555866659172284*^9, 3.555866697621989*^9}, {
   3.555866849804301*^9, 3.55586687285269*^9}, {3.555867155023143*^9, 
   3.555867183934344*^9}, {3.555867664245907*^9, 3.555867668925453*^9}, 
   3.555867718566052*^9, {3.555868075238261*^9, 3.555868147140597*^9}, {
   3.555868959789846*^9, 3.555869058605147*^9}, {3.555869118452616*^9, 
   3.555869154403113*^9}, {3.555869211498515*^9, 3.555869297737326*^9}, {
   3.555869332393053*^9, 3.555869407786221*^9}, 3.555869448145558*^9, {
   3.555869491825254*^9, 3.555869512552741*^9}, {3.555869597856168*^9, 
   3.555869638168175*^9}, {3.55586967378377*^9, 3.555869684630987*^9}, {
   3.555869788398902*^9, 3.555869953806032*^9}, {3.555870064828481*^9, 
   3.555870069298952*^9}, {3.555870294840233*^9, 3.555870295816032*^9}, {
   3.55587243932307*^9, 3.555872449032918*^9}, {3.556552388536805*^9, 
   3.556552445095322*^9}, {3.556738921680421*^9, 3.55673893387182*^9}, {
   3.556933180730269*^9, 3.556933249367585*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{"\"\<p-recursion.eps\>\"", ",", "pRecursion", ",", 
   RowBox[{"ImageSize", "\[Rule]", 
    RowBox[{"figureWidth", " ", 
     RowBox[{"2", "/", "3"}]}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.551924000708414*^9, 3.551924016032707*^9}, {
   3.552152764035075*^9, 3.552152771586495*^9}, {3.555081023503778*^9, 
   3.5550810525102882`*^9}, {3.555870287120741*^9, 3.555870302894979*^9}, 
   3.566591533071157*^9}],

Cell[BoxData["\<\"p-recursion.eps\"\>"], "Output",
 CellChangeTimes->{{3.555870304937695*^9, 3.555870307958464*^9}, 
   3.55655244988521*^9, 3.556738947626399*^9, 3.5567423942597017`*^9, 
   3.5569332702189198`*^9, 3.5569682258245792`*^9, {3.5665915715960617`*^9, 
   3.566591577709784*^9}, 3.5665916820360403`*^9}]
}, Open  ]],

Cell["\<\
The demand that the incorrect step fixed point be less than 1 provides the \
strongest constraint on model parameters.\
\>", "Text",
 CellChangeTimes->{{3.555941285346603*^9, 3.555941353048195*^9}}],

Cell[BoxData[
 RowBox[{"region", "=", 
  RowBox[{"Show", "[", 
   RowBox[{
    RowBox[{"Plot3D", "[", 
     RowBox[{
      RowBox[{"1", "-", 
       RowBox[{"ps", "/", 
        RowBox[{"(", 
         RowBox[{"1", "-", "pg"}], ")"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"pg", ",", "0", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ps", ",", "0", ",", "1"}], "}"}], ",", 
      RowBox[{"PlotStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"Opacity", "[", "0.5", "]"}], "}"}]}], ",", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}], ",", 
      RowBox[{"AxesLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\"\<\!\(\*
StyleBox[\"P\",
FontSlant->\"Italic\"]\)(G)\>\"", ",", "\"\<\!\(\*
StyleBox[\"P\",
FontSlant->\"Italic\"]\)(S)\>\"", ",", "\"\<\!\(\*
StyleBox[\"P\",
FontSlant->\"Italic\"]\)(T)\>\""}], "}"}]}], ",", 
      RowBox[{"ClippingStyle", "\[Rule]", "None"}], ",", 
      RowBox[{"BaseStyle", "\[Rule]", "journalStyle"}], ",", 
      RowBox[{"BoxStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"Thickness", "[", "0.0025", "]"}], "}"}]}]}], "]"}], ",", 
    RowBox[{"Graphics3D", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Opacity", "[", "0.2", "]"}], ",", 
       RowBox[{"Polygon", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1", ",", "1"}], "}"}]}], "}"}], "]"}]}], "}"}], 
     "]"}]}], 
   RowBox[{"(*", " ", 
    RowBox[{"ParametricPlot3D", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", 
        RowBox[{"1", "-", "x"}], ",", "z"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"z", ",", "0", ",", "1"}], "}"}], ",", 
      RowBox[{"Mesh", "\[Rule]", "4"}], ",", 
      RowBox[{"PlotStyle", "->", 
       RowBox[{"{", 
        RowBox[{"Opacity", "[", "0.2", "]"}], "}"}]}]}], "]"}], " ", "*)"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.555940846633565*^9, 3.55594088813242*^9}, {
   3.555940976314746*^9, 3.555940985996938*^9}, {3.555941054578692*^9, 
   3.555941132609736*^9}, {3.55594116692104*^9, 3.555941173497316*^9}, {
   3.555955545615243*^9, 3.555955547078943*^9}, {3.556552459764453*^9, 
   3.556552460877179*^9}, 3.566589452687715*^9, {3.566589575277326*^9, 
   3.566589577566133*^9}, {3.566590135338682*^9, 3.566590142592749*^9}, {
   3.566590437900833*^9, 3.56659044437728*^9}, {3.566990899522643*^9, 
   3.566990910025756*^9}, {3.566990999964712*^9, 3.566991055425351*^9}, {
   3.566991546947234*^9, 3.566991702909494*^9}, {3.56699173483829*^9, 
   3.566991792518326*^9}, {3.56699183375247*^9, 3.5669918569241953`*^9}, 
   3.566991913418981*^9, {3.566992459343582*^9, 3.5669925462325373`*^9}, {
   3.566992608418989*^9, 3.566992613409205*^9}, {3.566992652013753*^9, 
   3.566992652379342*^9}, {3.56699270877238*^9, 3.566992711680181*^9}, {
   3.5669927663832808`*^9, 3.566992796163988*^9}, {3.566992841604273*^9, 
   3.566992847658388*^9}, {3.566992905547741*^9, 3.566992923190195*^9}, {
   3.566992977615528*^9, 3.566993123363729*^9}, {3.56699317288898*^9, 
   3.5669932084617434`*^9}, {3.575750211708021*^9, 3.575750225080202*^9}, {
   3.575750272643866*^9, 3.5757503109018927`*^9}}],

Cell["\<\
See http://mathematica.stackexchange.com/questions/1542/exporting-graphics-to-\
pdf-huge-file\
\>", "Text",
 CellChangeTimes->{{3.575742383589717*^9, 3.575742393490135*^9}, {
  3.575742561123561*^9, 3.57574256984175*^9}, {3.575742635418396*^9, 
  3.575742711759871*^9}, {3.575750407265051*^9, 3.575750420271209*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{"\"\<region.pdf\>\"", ",", 
   RowBox[{"Rasterize", "[", 
    RowBox[{"region", ",", "\"\<Graphics\>\"", ",", 
     RowBox[{"ImageSize", "\[Rule]", 
      RowBox[{"figureWidth", " ", 
       RowBox[{"2", "/", "3"}]}]}], ",", 
     RowBox[{"RasterSize", "\[Rule]", "1200"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.551924000708414*^9, 3.551924016032707*^9}, {
   3.552152764035075*^9, 3.552152771586495*^9}, {3.555081023503778*^9, 
   3.5550810525102882`*^9}, {3.555870287120741*^9, 3.555870302894979*^9}, {
   3.566590465081046*^9, 3.566590474095586*^9}, 3.566591079412545*^9, {
   3.5669933641928463`*^9, 3.566993366013823*^9}, {3.5669934315498047`*^9, 
   3.5669934419877987`*^9}, {3.5757494112872458`*^9, 3.575749421604431*^9}, {
   3.575749584472908*^9, 3.575749601798579*^9}, {3.57574964622968*^9, 
   3.575749649108523*^9}, {3.5757497275131083`*^9, 3.57574974714334*^9}, {
   3.575749881183033*^9, 3.575749883893066*^9}, {3.5757499359109383`*^9, 
   3.5757499632435083`*^9}, {3.5757500125590773`*^9, 3.575750013395402*^9}}],

Cell[BoxData["\<\"region.pdf\"\>"], "Output",
 CellChangeTimes->{
  3.566590476331296*^9, 3.566591086562396*^9, 3.566991939911447*^9, 
   3.5669926731906147`*^9, 3.566992723651648*^9, {3.566992781145439*^9, 
   3.566992804489088*^9}, 3.566992852939323*^9, 3.5669929281197233`*^9, {
   3.566993108486388*^9, 3.566993131367505*^9}, {3.566993193793582*^9, 
   3.5669932137532597`*^9}, 3.566993385842269*^9, {3.566993435649508*^9, 
   3.5669934435157127`*^9}, 3.575749432731248*^9, 3.575749489806528*^9, 
   3.575749523731344*^9, 3.575749603560104*^9, 3.575749651865067*^9, {
   3.575749729536997*^9, 3.575749749318771*^9}, 3.575749885769285*^9, {
   3.5757499388748617`*^9, 3.575749964752211*^9}, 3.575750014784041*^9, 
   3.575750328547682*^9}]
}, Open  ]],

Cell["\<\
See how things change as one moves from positive to negative learning \
parameters.  We see that \[OpenCurlyDoubleQuote]Correct\
\[CloseCurlyDoubleQuote] and \[OpenCurlyDoubleQuote]incorrect\
\[CloseCurlyDoubleQuote] invert roles.\
\>", "Text",
 CellChangeTimes->{{3.55655081446606*^9, 3.556550844443576*^9}, {
  3.556551190308702*^9, 3.556551214156097*^9}}],

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{
   RowBox[{"Function", "[", 
    RowBox[{"vals", ",", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"plast", ",", 
         RowBox[{
          RowBox[{"recursion", "[", 
           RowBox[{"\"\<correct\>\"", ",", "plast"}], "]"}], "/.", "vals"}], 
         ",", 
         RowBox[{
          RowBox[{"recursion", "[", 
           RowBox[{"\"\<incorrect\>\"", ",", "plast"}], "]"}], "/.", 
          "vals"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"plast", ",", 
         RowBox[{"-", "0.01"}], ",", "1.01"}], "}"}], ",", 
       RowBox[{"Epilog", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"PointSize", "[", "Large", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"Red", ",", 
            RowBox[{"Point", "[", 
             RowBox[{"{", 
              RowBox[{"1", ",", "1"}], "}"}], "]"}], ",", 
            RowBox[{"Text", "[", 
             RowBox[{"\"\<step \!\(\*
StyleBox[\"j\",
FontSlant->\"Italic\"]\) correct\>\"", ",", 
              RowBox[{"{", 
               RowBox[{"0.5", ",", ".8"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Blue", ",", 
            RowBox[{"Point", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "1"}], "}"}], " ", "plast"}], "/.", 
               RowBox[{"fincorrect", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "/.", "vals"}], "]"}], ",", 
            
            RowBox[{"Text", "[", 
             RowBox[{"\"\<step \!\(\*
StyleBox[\"j\",
FontSlant->\"Italic\"]\) incorrect\>\"", ",", 
              RowBox[{"{", 
               RowBox[{"0.8", ",", ".3"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], "}"}]}], "}"}]}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Dashed", ",", "Red", ",", "Blue"}], "}"}]}], ",", 
       RowBox[{"AxesLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"SequenceForm", "[", 
           RowBox[{"\"\<\!\(\*
StyleBox[\"P\",
FontSlant->\"Italic\"]\)(\>\"", ",", 
            RowBox[{"Subscript", "[", 
             RowBox[{"\"\<\!\(\*
StyleBox[\"L\",
FontSlant->\"Italic\"]\)\>\"", ",", "\"\<\!\(\*
StyleBox[\"j\",
FontSlant->\"Italic\"]\)-1\>\""}], "]"}], ",", "\"\<)\>\""}], "]"}], ",", 
          RowBox[{"SequenceForm", "[", 
           RowBox[{"\"\<\!\(\*
StyleBox[\"P\",
FontSlant->\"Italic\"]\)(\>\"", ",", 
            RowBox[{"Subscript", "[", 
             RowBox[{"\"\<\!\(\*
StyleBox[\"L\",
FontSlant->\"Italic\"]\)\>\"", ",", "\"\<\!\(\*
StyleBox[\"j\",
FontSlant->\"Italic\"]\)\>\""}], "]"}], ",", "\"\<)\>\""}], "]"}]}], "}"}]}], 
       ",", 
       RowBox[{"BaseStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"FontSize", "\[Rule]", "12"}], "}"}]}]}], "]"}]}], "]"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ps", "->", "0.2"}], ",", " ", 
       RowBox[{"pg", "->", "0.2"}], ",", " ", 
       RowBox[{"pl", "->", "0.2"}], ",", " ", 
       RowBox[{"p0", "->", "0.36"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ps", "->", "0.4"}], ",", " ", 
       RowBox[{"pg", "->", "0.4"}], ",", " ", 
       RowBox[{"pl", "->", "0.2"}], ",", " ", 
       RowBox[{"p0", "->", "0.36"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ps", "->", "0.6"}], ",", " ", 
       RowBox[{"pg", "->", "0.6"}], ",", " ", 
       RowBox[{"pl", "->", "0.2"}], ",", " ", 
       RowBox[{"p0", "->", "0.36"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ps", "->", "0.8"}], ",", " ", 
       RowBox[{"pg", "->", "0.8"}], ",", " ", 
       RowBox[{"pl", "->", "0.2"}], ",", " ", 
       RowBox[{"p0", "->", "0.36"}]}], "}"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.555866659172284*^9, 3.555866697621989*^9}, {
   3.555866849804301*^9, 3.55586687285269*^9}, {3.555867155023143*^9, 
   3.555867183934344*^9}, {3.555867664245907*^9, 3.555867668925453*^9}, 
   3.555867718566052*^9, {3.555868075238261*^9, 3.555868147140597*^9}, {
   3.555868959789846*^9, 3.555869058605147*^9}, {3.555869118452616*^9, 
   3.555869154403113*^9}, {3.555869211498515*^9, 3.555869297737326*^9}, {
   3.555869332393053*^9, 3.555869407786221*^9}, 3.555869448145558*^9, {
   3.555869491825254*^9, 3.555869512552741*^9}, {3.555869597856168*^9, 
   3.555869638168175*^9}, {3.55586967378377*^9, 3.555869684630987*^9}, {
   3.555869788398902*^9, 3.555869953806032*^9}, {3.555870064828481*^9, 
   3.555870069298952*^9}, {3.555870294840233*^9, 3.555870295816032*^9}, {
   3.55587243932307*^9, 3.555872449032918*^9}, {3.556550849253928*^9, 
   3.55655093986041*^9}, {3.55655097754038*^9, 3.556551014034916*^9}, {
   3.556551135498101*^9, 3.556551139567649*^9}, {3.556552483075386*^9, 
   3.556552488310921*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["BKT model fits to synthetic data", "Subsection",
 CellChangeTimes->{{3.6955971159896297`*^9, 3.69559712681621*^9}, {
  3.696000626071541*^9, 3.696000633935626*^9}, {3.699618338985504*^9, 
  3.699618341883793*^9}}],

Cell["\<\
Compare residual sum of squares (RSS) fit and maximum likelihood fit to BKT \
model for a synthetic dataset.\
\>", "Text",
 CellChangeTimes->{{3.69559735229725*^9, 3.695597365281098*^9}, 
   3.69566405997078*^9, {3.696000532023594*^9, 3.696000594625538*^9}}],

Cell[CellGroupData[{

Cell["Code", "Subsubsection",
 CellChangeTimes->{{3.699618399385895*^9, 3.699618403023327*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"generateSequences", "[", 
    RowBox[{"vars_", ",", "n_", ",", "m_"}], "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"generateSequence", "[", 
      RowBox[{"vars", ",", "n"}], "]"}], ",", 
     RowBox[{"{", "m", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"generateSequence", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"p0_", ",", "pL_", ",", "pG_", ",", "pS_"}], "}"}], ",", "n_"}], 
   "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"p0", ">", 
         RowBox[{"RandomReal", "[", "]"}]}], ",", "1", ",", "0"}], "]"}]}], 
     "}"}], ",", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"y", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Which", "[", 
              RowBox[{
               RowBox[{"x", "\[Equal]", "1"}], ",", 
               RowBox[{"1", "-", "pS"}], ",", 
               RowBox[{"x", "\[Equal]", "0"}], ",", "pG"}], "]"}], ">", 
             RowBox[{"RandomReal", "[", "]"}]}], ",", "1", ",", "0"}], 
           "]"}]}], "}"}], ",", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"Update", " ", "step"}], ",", " ", 
          RowBox[{"no", " ", "forgetting"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"x", "\[Equal]", "0"}], " ", "&&", " ", 
            RowBox[{"pL", ">", 
             RowBox[{"RandomReal", "[", "]"}]}]}], ",", 
           RowBox[{"x", "=", "1"}]}], "]"}], ";", "y"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], "]"}]}]}], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.69565935245716*^9, 3.695659394869894*^9}, {
  3.695659440358789*^9, 3.695659479180884*^9}, {3.695659569299182*^9, 
  3.695659594362603*^9}, {3.695659634115511*^9, 3.6956596541753597`*^9}, {
  3.695659702342749*^9, 3.695659945321377*^9}, {3.695660134380278*^9, 
  3.6956601374533043`*^9}, {3.6956601997923517`*^9, 3.695660205219558*^9}, {
  3.6956604537034273`*^9, 3.6956604796526537`*^9}, {3.695660514590173*^9, 
  3.6956605328921757`*^9}, {3.695660593331018*^9, 3.695660601785906*^9}, {
  3.695660955906519*^9, 3.695661018255939*^9}, {3.695661061771799*^9, 
  3.6956610707144203`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"markovChain", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"p0_", ",", "pL_", ",", "pG_", ",", "pS_"}], "}"}], ",", 
    "step_"}], "]"}], ":=", 
  RowBox[{"1", "-", "pS", "-", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", "pS", "-", "pG"}], ")"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", "p0"}], ")"}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "pL"}], ")"}], "^", 
     RowBox[{"(", 
      RowBox[{"step", "-", "1"}], ")"}]}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.695663024576314*^9, 3.6956631465981817`*^9}, {
  3.695663184581851*^9, 3.695663329715316*^9}, {3.69566346868717*^9, 
  3.695663471884007*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Wrapper", " ", "to", " ", "allow", " ", "variables", " ", "to", " ", "be",
     " ", "input", " ", "as", " ", "a", " ", "vector"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"forwardCalls", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"forwardAlgorithm", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"p0_", "?", "NumberQ"}], ",", 
         RowBox[{"pA_", "?", "NumberQ"}], ",", 
         RowBox[{"pG_", "?", "NumberQ"}], ",", 
         RowBox[{"pS_", "?", "NumberQ"}]}], "}"}], ",", "Data_", ",", 
       RowBox[{"rss_:", "False"}]}], "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"forwardCalls", "++"}], ";", 
       RowBox[{"forwardCompiled", "[", 
        RowBox[{
        "p0", ",", "pA", ",", "pG", ",", "pS", ",", "Data", ",", "rss"}], 
        "]"}]}], ")"}]}], ";", 
    RowBox[{"forwardCompiled", "=", 
     RowBox[{"Compile", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"p0in", ",", "_Real"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"pA", ",", "_Real"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"pGin", ",", "_Real"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"pS", ",", "_Real"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Data", ",", "_Integer", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"rss", ",", 
           RowBox[{"True", "|", "False"}]}], "}"}]}], "}"}], ",", 
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"p0", "=", "p0in"}], ",", 
           RowBox[{"pG", "=", "pGin"}], ",", "colind", ",", "pL", ",", 
           RowBox[{"cols", "=", 
            RowBox[{"Length", "[", 
             RowBox[{"Data", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", "rowind", ",", 
           RowBox[{"subs", "=", 
            RowBox[{"Length", "[", "Data", "]"}]}], ",", "PrdctCrd", ",", 
           RowBox[{"sum", "=", "0.0"}], ",", 
           RowBox[{"logLike", "=", "0.0"}], ",", "EmpCrd", ",", 
           RowBox[{"td", "=", 
            RowBox[{"{", 
             RowBox[{"{", "0.0", "}"}], "}"}]}], ",", "pp"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Work", "-", 
           RowBox[{"around", " ", "for", " ", "compiler", " ", 
            RowBox[{"bug", ":", " ", 
             RowBox[{"explicitly", " ", "set", " ", "type", " ", "of", " ", 
              RowBox[{"Transpose", "."}]}]}]}]}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"EmpCrd", "=", 
           RowBox[{"Map", "[", 
            RowBox[{"Mean", ",", 
             RowBox[{"td", "=", 
              RowBox[{"Transpose", "[", "Data", "]"}]}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"The", " ", "case", " ", "pG"}], "=", 
             RowBox[{"p0", "=", 
              RowBox[{"0", " ", "is", " ", "numerically", " ", 
               RowBox[{"pathological", ".", "  ", "In"}], " ", "that", " ", 
               "case"}]}]}], ",", " ", 
            RowBox[{
            "we", " ", "just", " ", "shift", " ", "the", " ", "points", " ", 
             "a", " ", 
             RowBox[{"bit", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"p0", "\[Equal]", "0"}], " ", "&&", " ", 
             RowBox[{"pG", "\[Equal]", "0"}]}], ",", 
            RowBox[{"p0", "=", 
             RowBox[{"pG", "=", 
              RowBox[{"10.0", "^", 
               RowBox[{"-", "6"}]}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
          
          RowBox[{"(*", " ", 
           RowBox[{
           "This", " ", "is", " ", "an", " ", "almost", " ", "exact", " ", 
            "copy", " ", "of", " ", "the", " ", "function", " ", "FuncNB", 
            RowBox[{"(", ")"}], "\[IndentingNewLine]", "in", " ", 
            RowBox[{"NVL1GrMemFitAUTNoBound", ".", "c"}], " ", "used", " ", 
            "in", " ", "the", " ", "earlier", " ", "BKT", " ", 
            RowBox[{
            "papers", ".", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             "subs"}], " ", "is", " ", "the", " ", "number", " ", "of", " ", 
            "students", " ", "\[IndentingNewLine]", "cols", " ", "is", " ", 
            "the", " ", "number", " ", "of", " ", "steps", " ", 
            RowBox[{"(", "opportunities", ")"}]}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"PrdctCrd", "=", 
           RowBox[{"Table", "[", 
            RowBox[{"0.", ",", 
             RowBox[{"{", "cols", "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"rowind", "=", "1"}], ",", 
            RowBox[{"rowind", "<=", "subs"}], ",", 
            RowBox[{"rowind", "++"}], ",", "\n", 
            RowBox[{
             RowBox[{"pL", "=", "p0"}], ";", "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"colind", "=", "1"}], ",", 
               RowBox[{"colind", "<=", "cols"}], ",", 
               RowBox[{"colind", "++"}], ",", " ", 
               RowBox[{
                RowBox[{"If", " ", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Data", "[", 
                    RowBox[{"[", 
                    RowBox[{"rowind", ",", "colind"}], "]"}], "]"}], 
                   "\[Equal]", 
                   RowBox[{"-", "1"}]}], ",", " ", 
                  RowBox[{"Break", "[", "]"}]}], "]"}], ";", " ", 
                RowBox[{"(*", " ", 
                 RowBox[{"This", " ", "row", " ", "is", " ", 
                  RowBox[{"done", "."}]}], " ", "*)"}], 
                RowBox[{"pp", "=", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"pL", "*", 
                    RowBox[{"(", 
                    RowBox[{"1.0", "-", "pS"}], ")"}]}], ")"}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1.0", "-", "pL"}], ")"}], "*", "pG"}]}]}], ";", 
                RowBox[{
                 RowBox[{"PrdctCrd", "[", 
                  RowBox[{"[", "colind", "]"}], "]"}], "+=", "pp"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"(*", " ", 
                 RowBox[{
                  RowBox[{
                  "Calculation", " ", "of", " ", "the", " ", "log", " ", 
                   RowBox[{"likelihood", ".", " ", "This"}], " ", "is", " ", 
                   "an", " ", "add"}], "-", 
                  RowBox[{"on", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
                RowBox[{"logLike", " ", "+=", " ", 
                 RowBox[{"Which", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"pp", "\[LessEqual]", "0"}], " ", "||", " ", 
                    RowBox[{"pp", "\[GreaterEqual]", "1"}]}], ",", 
                   RowBox[{"-", 
                    RowBox[{"10.0", "^", "6"}]}], ",", 
                   RowBox[{
                    RowBox[{"Data", "[", 
                    RowBox[{"[", 
                    RowBox[{"rowind", ",", "colind"}], "]"}], "]"}], 
                    "\[Equal]", "1"}], ",", " ", 
                   RowBox[{"Log", "[", "pp", "]"}], ",", 
                   RowBox[{
                    RowBox[{"Data", "[", 
                    RowBox[{"[", 
                    RowBox[{"rowind", ",", "colind"}], "]"}], "]"}], 
                    "\[Equal]", "0"}], ",", 
                   RowBox[{"Log", "[", 
                    RowBox[{"1.0", "-", "pp"}], "]"}]}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"Which", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Data", "[", 
                    RowBox[{"[", 
                    RowBox[{"rowind", ",", "colind"}], "]"}], "]"}], 
                   "\[Equal]", "1"}], ",", " ", 
                  RowBox[{
                   RowBox[{"pL", "=", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"pL", "*", 
                    RowBox[{"(", 
                    RowBox[{"1.0", "-", "pS"}], ")"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"pL", "*", 
                    RowBox[{"(", 
                    RowBox[{"1.0", "-", "pS"}], ")"}]}], ")"}], "+", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1.0", "-", "pL"}], ")"}], "*", "pG"}], ")"}]}], 
                    ")"}]}]}], ";", "\[IndentingNewLine]", 
                   RowBox[{"pL", "=", 
                    RowBox[{"pL", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1.0", "-", "pL"}], ")"}], "*", "pA"}]}]}]}], ",",
                   "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Data", "[", 
                    RowBox[{"[", 
                    RowBox[{"rowind", ",", "colind"}], "]"}], "]"}], 
                   "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"pL", "=", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"pL", "*", "pS"}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"pL", "*", "pS"}], ")"}], "+", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1.0", "-", "pL"}], ")"}], "*", 
                    RowBox[{"(", 
                    RowBox[{"1.0", "-", "pG"}], ")"}]}], ")"}]}], ")"}]}]}], 
                   ";", "\[IndentingNewLine]", 
                   RowBox[{"pL", "=", 
                    RowBox[{"pL", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1.0", "-", "pL"}], ")"}], "*", "pA"}]}]}], 
                   ";"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"colind", "=", "1"}], ",", 
            RowBox[{"colind", "<=", "cols"}], ",", 
            RowBox[{"colind", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
              "Since", " ", "there", " ", "is", " ", "no", " ", "missing", 
               " ", "data"}], ",", " ", 
              RowBox[{"we", " ", "remove", " ", "the", " ", "weights"}]}], 
             " ", "*)"}], "\n", 
            RowBox[{
             RowBox[{
              RowBox[{"PrdctCrd", "[", 
               RowBox[{"[", "colind", "]"}], "]"}], "=", 
              RowBox[{
               RowBox[{"PrdctCrd", "[", 
                RowBox[{"[", "colind", "]"}], "]"}], "/", "subs"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"sum", "+=", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"PrdctCrd", "[", 
                  RowBox[{"[", "colind", "]"}], "]"}], "-", 
                 RowBox[{"EmpCrd", "[", 
                  RowBox[{"[", "colind", "]"}], "]"}]}], ")"}], "^", 
               "2"}]}]}]}], "]"}], ";", "\n", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"Return", " ", "minus", " ", "log", " ", "likelihood"}], 
            ",", " ", 
            RowBox[{"so", " ", "we", " ", "are", " ", "still", " ", 
             RowBox[{"minimizing", "."}]}]}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{"rss", ",", "sum", ",", 
            RowBox[{"-", "logLike"}]}], "]"}]}]}], "]"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.695597202914208*^9, 3.695597202915944*^9}, {
   3.695597337467952*^9, 3.6955974023358107`*^9}, {3.695598080497293*^9, 
   3.695598099838698*^9}, {3.695654707828856*^9, 3.695654815520308*^9}, {
   3.6956548467058067`*^9, 3.6956549095341263`*^9}, {3.695654939694146*^9, 
   3.695655083754092*^9}, {3.695655117785179*^9, 3.695655120361793*^9}, {
   3.695663839546989*^9, 3.695664007844467*^9}, {3.695664063091658*^9, 
   3.6956641161709003`*^9}, {3.695665568805184*^9, 3.695665569108479*^9}, {
   3.69566561877943*^9, 3.695665639362261*^9}, {3.695665704384873*^9, 
   3.695665790541381*^9}, {3.695665830157325*^9, 3.6956659148284683`*^9}, {
   3.695665978024783*^9, 3.695666122947392*^9}, {3.695677313760727*^9, 
   3.695677364396989*^9}, {3.695677463107593*^9, 3.695677498878502*^9}, {
   3.6956776770410213`*^9, 3.6956776955439987`*^9}, {3.6956777949880753`*^9, 
   3.695677843304584*^9}, {3.6956778796857224`*^9, 3.6956779184430304`*^9}, {
   3.695678008462611*^9, 3.695678032147297*^9}, {3.695678147565097*^9, 
   3.6956782869639683`*^9}, {3.695686123566725*^9, 3.695686202569243*^9}, {
   3.6956862387353153`*^9, 3.6956863518968773`*^9}, {3.6956910299841757`*^9, 
   3.6956910379825773`*^9}, {3.695691370092877*^9, 3.69569140241049*^9}, {
   3.695692324947093*^9, 3.695692341331395*^9}, {3.695730151369068*^9, 
   3.6957302462089863`*^9}, {3.695732933918934*^9, 3.695732937109611*^9}, {
   3.695735728534638*^9, 3.695735763381071*^9}, {3.69573610880982*^9, 
   3.695736114896612*^9}, 3.69573619826994*^9, {3.695736863950631*^9, 
   3.695736988149295*^9}, {3.695755703291369*^9, 3.695755737368227*^9}, {
   3.695846734714364*^9, 3.695846745679574*^9}, {3.695846958414516*^9, 
   3.6958469667970667`*^9}, {3.6960006668134737`*^9, 3.696000726304677*^9}, {
   3.699438690426042*^9, 3.699438697309277*^9}, {3.699787279578168*^9, 
   3.699787299007518*^9}, {3.699787555795577*^9, 3.699787620984095*^9}, {
   3.699787685830471*^9, 3.699787720227993*^9}, {3.6997880787783747`*^9, 
   3.699788173019668*^9}, {3.6997882221575937`*^9, 3.69978822365403*^9}, {
   3.6997882784254847`*^9, 3.699788379745943*^9}, {3.699788409822836*^9, 
   3.699788425451275*^9}, {3.699788465080744*^9, 3.699788467599638*^9}, {
   3.6997885553930273`*^9, 3.699788558906849*^9}, {3.699788945696827*^9, 
   3.699788964880632*^9}, 3.699789117505949*^9, {3.699789165398739*^9, 
   3.699789220298943*^9}, 3.699789254151267*^9, {3.699789438723175*^9, 
   3.699789484023799*^9}, {3.699789671406522*^9, 3.6997897184190683`*^9}, {
   3.699789749074032*^9, 3.699789765105207*^9}, {3.6997898022722054`*^9, 
   3.699789809343773*^9}, {3.699789863710719*^9, 3.699789898692026*^9}, {
   3.6997899892325163`*^9, 3.699790058531816*^9}, {3.699790119136147*^9, 
   3.699790177110319*^9}, {3.6997902376198797`*^9, 3.69979025149114*^9}, {
   3.699790301598386*^9, 3.699790393995741*^9}, {3.69979062443405*^9, 
   3.699790652408948*^9}, {3.699790824400572*^9, 3.6997908449443207`*^9}, {
   3.699790952307233*^9, 3.699791101205801*^9}, {3.699791241590551*^9, 
   3.699791254235606*^9}, {3.699791851013135*^9, 3.6997918547905083`*^9}, {
   3.699791902076075*^9, 3.699791943730742*^9}, 3.699793062166136*^9, {
   3.699793834449374*^9, 3.69979384974411*^9}, {3.6997942018575773`*^9, 
   3.699794227190077*^9}, {3.69979425977173*^9, 3.699794314281682*^9}, {
   3.699794728724057*^9, 3.6997947339387627`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"colorFunction", "[", "x_", "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"x", ">", "1"}], ",", 
    RowBox[{"GrayLevel", "[", "0", "]"}], " ", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Work", " ", "around", " ", "for", " ", "bug", " ", "when", " ", "the", 
      " ", "value", " ", "is", " ", "of", " ", 
      RowBox[{"range", "."}]}], " ", "*)"}], ",", 
    RowBox[{"GrayLevel", "[", 
     RowBox[{"1", "-", 
      RowBox[{"x", "/", "2"}]}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.699381070916217*^9, 3.6993810981702147`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "values", " ", "from", " ", "Table", " ", "1", " ", "of", " ", "Beck", " ",
     "and", " ", "Chang"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"v0", "=", 
     RowBox[{"{", 
      RowBox[{"0.56", ",", "0.1", ",", "0.0", ",", "0.05"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"v1", "=", 
     RowBox[{"{", 
      RowBox[{"0.36", ",", "0.1", ",", "0.3", ",", "0.05"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"v2", "=", 
     RowBox[{"{", 
      RowBox[{"0.01", ",", "0.1", ",", "0.53", ",", "0.05"}], "}"}]}], 
    ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.695659957728218*^9, 3.695659988984089*^9}, {
  3.695660149147863*^9, 3.695660171523714*^9}, {3.69566373861961*^9, 
  3.6956637560352907`*^9}, {3.695666576851858*^9, 3.695666595691436*^9}, {
  3.695684336807169*^9, 3.695684376515987*^9}, {3.699443134211253*^9, 
  3.699443153916583*^9}, {3.699791515563347*^9, 3.699791517282526*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"markovChainRegion", "=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"p0", ",", "pL", ",", "pG", ",", "pS"}], "}"}], ",", 
     RowBox[{"ImplicitRegion", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"0", "<", "p0", "<", "1"}], "&&", 
        RowBox[{"0", "<", "pG"}], "&&", 
        RowBox[{"0", "<", "pS"}], "&&", 
        RowBox[{
         RowBox[{"pG", "+", "pS"}], "<", "1"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"p0", ",", "pL", ",", "pG", ",", "pS"}], "}"}]}], "]"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"frameLabel", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<\!\(\*
StyleBox[\"P\",
FontSlant->\"Italic\"]\)(\!\(\*
StyleBox[\"G\",
FontSlant->\"Italic\"]\))\>\"", ",", "\"\<\!\(\*
StyleBox[\"P\",
FontSlant->\"Italic\"]\)(\!\(\*SubscriptBox[
StyleBox[\"L\",
FontSlant->\"Italic\"], \"0\"]\))\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"liner", "[", 
    RowBox[{"p_", ",", 
     RowBox[{"r_:", "0.02"}]}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"p", "-", 
         RowBox[{"{", 
          RowBox[{"r", ",", "0"}], "}"}]}], ",", 
        RowBox[{"p", "+", 
         RowBox[{"{", 
          RowBox[{"r", ",", "0"}], "}"}]}]}], "}"}], "]"}], ",", 
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"p", "-", 
         RowBox[{"{", 
          RowBox[{"0", ",", "r"}], "}"}]}], ",", 
        RowBox[{"p", "+", 
         RowBox[{"{", 
          RowBox[{"0", ",", "r"}], "}"}]}]}], "}"}], "]"}]}], "}"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6994060557595577`*^9, 3.699406083444643*^9}, {
   3.69940651339819*^9, 3.699406517996635*^9}, {3.699408179393035*^9, 
   3.699408205550816*^9}, {3.699408632470429*^9, 3.699408648446278*^9}, {
   3.699437355964216*^9, 3.6994374282204*^9}, {3.69943748966621*^9, 
   3.699437525351985*^9}, {3.699437579015667*^9, 3.6994376171752367`*^9}, {
   3.699443155529375*^9, 3.699443174434156*^9}, 3.699443214441134*^9, {
   3.699800772954962*^9, 3.699800777674312*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Analysis", "Subsubsection",
 CellChangeTimes->{{3.6996183600346518`*^9, 3.699618365957675*^9}}],

Cell["Test global fit", "Text",
 CellChangeTimes->{{3.699800863663241*^9, 3.699800874579287*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fitPoints", "=", "25"}], ",", 
     RowBox[{"students", "=", "100"}], ",", "data"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"data", "=", 
     RowBox[{"generateSequences", "[", 
      RowBox[{"v1", ",", "fitPoints", ",", "students"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Find", " ", "global", " ", "minimum"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"Timing", "[", 
     RowBox[{"FindMinimum", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"forwardAlgorithm", "[", 
          RowBox[{"vars", ",", "data", ",", "True"}], "]"}], ",", 
         RowBox[{"Element", "[", 
          RowBox[{"vars", ",", "markovChainRegion"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"vars", ",", "v1"}], "}"}]}], "]"}], "]"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.6998008799333572`*^9, 3.699800962640431*^9}, {
  3.699800998289413*^9, 3.699801015392241*^9}, {3.699801296225154*^9, 
  3.699801299408493*^9}, {3.699801835721944*^9, 3.699802226420226*^9}, {
  3.699802284232894*^9, 3.699802310016554*^9}, {3.6998024262586946`*^9, 
  3.69980242767444*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"16.77462999999999837541508895810693502426`7.2452528629414905", ",", 
   RowBox[{"{", 
    RowBox[{"0.014749164653062469`", ",", 
     RowBox[{"{", 
      RowBox[{"vars", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
        "0.4016711387770675`", ",", "0.14669616285819673`", ",", 
         "0.26245329410738616`", ",", "0.06303867999399293`"}], "}"}]}], 
      "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6998022953627*^9, 3.699802336926046*^9, 
  3.699802390895528*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Clear", "[", "vars", "]"}]], "Input",
 CellChangeTimes->{{3.69980236587059*^9, 3.6998023687960253`*^9}}],

Cell["3-dimensional plot of surface", "Text",
 CellChangeTimes->{{3.699379980668125*^9, 3.699380017624179*^9}}],

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"data", "=", 
      RowBox[{"generateSequences", "[", 
       RowBox[{"v1", ",", "25", ",", "10"}], "]"}]}], ",", "p0", ",", 
     RowBox[{"pL", "=", 
      RowBox[{"v1", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ",", "pG", ",", 
     RowBox[{"pS", "=", 
      RowBox[{"v1", "[", 
       RowBox[{"[", "4", "]"}], "]"}]}]}], "}"}], ",", 
   RowBox[{"Plot3D", "[", 
    RowBox[{
     RowBox[{"forwardAlgorithm", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"p0", ",", "pL", ",", "pG", ",", "pS"}], "}"}], ",", "data", 
       ",", "False"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"pG", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"p0", ",", "0.01", ",", "1"}], "}"}], ",", 
     RowBox[{"AxesLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<pG\>\"", ",", "\"\<p0\>\""}], "}"}]}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"If", "[", 
       RowBox[{"True", ",", "Automatic", ",", 
        RowBox[{"{", 
         RowBox[{"0.0", ",", "0.5"}], "}"}]}], "]"}]}]}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQAGIQndhdMuFrx2tHpYdai0G0B8eZlSA6KjVwDYjWuDzj
AogWnxNwGUQ33v1yG0TbNe27B6I32aR8ANEVuTvBtNRt/h8gevKVlF8gevWU
BezfgPTFcm0+ED3hWYMIiF70eQeYNlnlKAmiJS56gembh77Ig+iOa3wKIPrz
tbwYEH3q0BowrcdgkALm2+8G0zwnfpz4AaSflSqdBNF7pmv/ANFZd5R/g2ir
SawMP4E0b0ghmJ5UrsIJojl0l4DpiwbXxED0lcJHYLrIX04PREe0tINpg3kf
rUD0y+M/wHRuaOthxgmvHQt89oDpfWtkeE4D6X+SHmB6Ra5/DohesKizBETL
1VVUgOhtE0+A6VkVtrNBdER/H5gGAIjZ3HM=
  "]],

Cell["\<\
There are two cases:  
1.  We pin the value of pL and pS to the same that was used to generate the \
data. This plot is quicker to generate, but less interesting.
2.  We minimize the residual sum of squares (RSS) to find the values of pL \
and pS for a given p0 and pG, plotting the best fit RSS.  This takes a while \
to run, but is what you would want to show in a paper...
For the paper, use 25 points and 100 students.

Junchen Feng, junchen@uchicago.edu\
\>", "Text",
 CellChangeTimes->{{3.6957343628268337`*^9, 3.695734408307*^9}, {
  3.699379950019816*^9, 3.6993799663782463`*^9}, {3.699442379922984*^9, 
  3.6994424720957327`*^9}, {3.699443439194412*^9, 3.69944345688936*^9}, {
  3.699443722123811*^9, 3.699443723060021*^9}, {3.699444836756258*^9, 
  3.699444851962207*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fitPoints", "=", "25"}], ",", 
     RowBox[{"students", "=", "100"}], ",", 
     RowBox[{"nContours", "=", "10"}], ",", "data", ",", "p0", ",", 
     RowBox[{"pL", "=", 
      RowBox[{"v1", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ",", "pG", ",", 
     RowBox[{"pS", "=", 
      RowBox[{"v1", "[", 
       RowBox[{"[", "4", "]"}], "]"}]}], ",", "aa", ",", "contours", ",", 
     "min", ",", "minPoint"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"data", "=", 
     RowBox[{"generateSequences", "[", 
      RowBox[{"v1", ",", "fitPoints", ",", "students"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Find", " ", "global", " ", "minimum"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", "=", 
        RowBox[{"FindMinimum", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"forwardAlgorithm", "[", 
             RowBox[{"vars", ",", "data", ",", "True"}], "]"}], ",", 
            RowBox[{"Element", "[", 
             RowBox[{"vars", ",", "markovChainRegion"}], "]"}]}], "}"}], ",", 
          
          RowBox[{"{", 
           RowBox[{"vars", ",", "v1"}], "}"}]}], "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"min", "=", 
        RowBox[{"x", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Minumum at \>\"", ",", 
         RowBox[{"minPoint", "=", 
          RowBox[{"x", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "1", ",", "2", ",", 
             RowBox[{"{", 
              RowBox[{"3", ",", "1"}], "}"}]}], "]"}], "]"}]}]}], "]"}]}]}], 
     "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"Specify", " ", "s"}], "-", "standard", "-", 
       RowBox[{"deviation", " ", 
        RowBox[{"contours", ".", " ", "\[IndentingNewLine]", "See"}], " ", 
        RowBox[{"Eqn", ".", " ", 
         RowBox[{"(", "38.13", ")"}]}], " ", "in", " ", 
        RowBox[{"http", ":"}]}]}], "//", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"pdg", ".", "lbl", ".", "gov"}], "/", "2014"}], "/", 
         "reviews"}], "/", "rpp2014"}], "-", "rev", "-", 
       RowBox[{"statistics", ".", "pdf"}]}]}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"contours", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"min", "+", 
        RowBox[{"0.5", "*", 
         RowBox[{"fitPoints", "/", "students"}], "*", 
         RowBox[{
          RowBox[{"s", "^", "2"}], "/", 
          RowBox[{"nContours", "^", "2"}]}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"s", ",", "1", ",", "nContours"}], "}"}]}], "]"}]}], ";", 
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Contours: \>\"", ",", "contours"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"aa", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "pS", "-", 
         RowBox[{"v1", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"v1", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"plot1", "=", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"ContourPlot", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{"False", 
           RowBox[{"(*", " ", 
            RowBox[{
            "Choose", " ", "between", " ", "fixed", " ", "value", " ", "and", 
             " ", "fitting", " ", "for", " ", "pL", " ", "and", " ", 
             RowBox[{"pS", "."}]}], " ", "*)"}], ",", 
           RowBox[{"forwardAlgorithm", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"p0", ",", "pL", ",", "pG", ",", "pS"}], "}"}], ",", 
             "data", ",", "True"}], "]"}], ",", 
           RowBox[{"Block", "[", 
            RowBox[{
             RowBox[{"{", "x", "}"}], ",", 
             RowBox[{"(*", " ", 
              RowBox[{
               RowBox[{
               "Minimization", " ", "must", " ", "be", " ", "unconstrained"}],
                ",", " ", 
               RowBox[{
               "else", " ", "it", " ", "is", " ", "way", " ", "too", " ", 
                RowBox[{"slow", "."}]}]}], " ", "*)"}], 
             RowBox[{
              RowBox[{"x", "=", 
               RowBox[{"FindMinimum", "[", 
                RowBox[{
                 RowBox[{"forwardAlgorithm", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"p0", ",", "pL", ",", "pG", ",", "pS"}], "}"}], 
                   ",", "data", ",", "True"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"pL", ",", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"pS", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], "<", 
                    RowBox[{"1", "-", "pG"}]}], ",", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pG"}], ")"}], "/", "2"}]}], "]"}], ",",
                     "0", ",", 
                    RowBox[{"1", "-", "pG"}]}], "}"}]}], "}"}], ",", 
                 RowBox[{"MaxIterations", "\[Rule]", "100"}]}], "]"}]}], ";", 
              
              RowBox[{"x", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"pG", ",", "0.0", ",", "0.7"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"p0", ",", "0.0", ",", "0.7"}], "}"}], ",", 
         RowBox[{"MaxRecursion", "\[Rule]", "1"}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", "frameLabel"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"If", "[", 
           RowBox[{"True", ",", 
            RowBox[{"{", 
             RowBox[{"min", ",", 
              RowBox[{"contours", "[", 
               RowBox[{"[", 
                RowBox[{"-", "1"}], "]"}], "]"}]}], "}"}], ",", "Automatic"}],
            "]"}]}], ",", 
         RowBox[{"ColorFunction", "\[Rule]", "colorFunction"}], ",", 
         RowBox[{"Contours", "\[Rule]", "contours"}], ",", 
         RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
         RowBox[{"Epilog", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"PointSize", "[", "Medium", "]"}], ",", 
            RowBox[{"Point", "[", 
             RowBox[{"v0", "[", 
              RowBox[{"[", 
               RowBox[{"{", 
                RowBox[{"3", ",", "1"}], "}"}], "]"}], "]"}], "]"}], ",", 
            RowBox[{"Point", "[", 
             RowBox[{"v1", "[", 
              RowBox[{"[", 
               RowBox[{"{", 
                RowBox[{"3", ",", "1"}], "}"}], "]"}], "]"}], "]"}], ",", 
            RowBox[{"Point", "[", 
             RowBox[{"v2", "[", 
              RowBox[{"[", 
               RowBox[{"{", 
                RowBox[{"3", ",", "1"}], "}"}], "]"}], "]"}], "]"}]}], 
           "}"}]}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "figureWidth"}], ",", 
         RowBox[{"BaseStyle", "\[Rule]", 
          RowBox[{"If", "[", 
           RowBox[{"True", ",", "journalStyle", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"PointSize", "[", "0.02", "]"}], ",", 
              RowBox[{"Thickness", "[", "0.008", "]"}], ",", 
              RowBox[{"FontSize", "\[Rule]", "24"}]}], "}"}]}], "]"}]}]}], 
        "]"}], ",", 
       RowBox[{"plot1b", "=", 
        RowBox[{"Plot", "[", 
         RowBox[{
          RowBox[{"1", "-", 
           RowBox[{"aa", "/", 
            RowBox[{"(", 
             RowBox[{"1", "-", "pS", "-", "pg"}], ")"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"pg", ",", "0", ",", 
            RowBox[{"1", "-", "pS", "-", "aa"}]}], "}"}], ",", 
          RowBox[{"Axes", "\[Rule]", "False"}], ",", 
          RowBox[{"BaseStyle", "\[Rule]", "journalStyle"}]}], "]"}]}]}], 
      "]"}]}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.695684739642014*^9, 3.695684889339982*^9}, {
   3.695684942376011*^9, 3.695684962543622*^9}, {3.695685252775776*^9, 
   3.695685274519054*^9}, {3.695685343652039*^9, 3.6956853659533987`*^9}, {
   3.695685507132409*^9, 3.695685509794613*^9}, {3.695685568495496*^9, 
   3.695685587150949*^9}, {3.695685693018148*^9, 3.695685745358376*^9}, {
   3.695685796028145*^9, 3.6956857977797403`*^9}, {3.6956858340520267`*^9, 
   3.695685834338024*^9}, {3.695685887648785*^9, 3.695685888463688*^9}, {
   3.695686371463739*^9, 3.695686373398778*^9}, {3.695686433500022*^9, 
   3.6956864378515368`*^9}, {3.69569133577442*^9, 3.695691337076892*^9}, {
   3.6956917133622723`*^9, 3.695691737120656*^9}, {3.6956917761741*^9, 
   3.69569177954151*^9}, {3.695691849139596*^9, 3.695691853130497*^9}, {
   3.695691958693459*^9, 3.695691959076395*^9}, {3.695692144947198*^9, 
   3.6956921482349052`*^9}, {3.69569224755056*^9, 3.695692247774403*^9}, {
   3.6957306839163237`*^9, 3.695730759080119*^9}, {3.695730828666486*^9, 
   3.695730829523726*^9}, {3.6957309079152327`*^9, 3.6957309090312223`*^9}, 
   3.695730966467939*^9, {3.6957317444679937`*^9, 3.6957317568530083`*^9}, {
   3.695731956736779*^9, 3.695732078632155*^9}, {3.695732126590425*^9, 
   3.695732147404046*^9}, {3.6957321791791563`*^9, 3.695732277996274*^9}, {
   3.695732336089243*^9, 3.69573234568036*^9}, {3.6957324627046824`*^9, 
   3.695732468377056*^9}, {3.695732517358057*^9, 3.695732540229974*^9}, {
   3.695732575763887*^9, 3.6957326363195467`*^9}, {3.695732864561801*^9, 
   3.695732869929305*^9}, {3.695733031408703*^9, 3.69573309024516*^9}, {
   3.6957331420036383`*^9, 3.6957331427451353`*^9}, {3.695733319727084*^9, 
   3.695733322940084*^9}, {3.695733479421822*^9, 3.69573352140257*^9}, {
   3.695733576814838*^9, 3.695733577334581*^9}, {3.695734118929515*^9, 
   3.695734138820889*^9}, {3.6993797281447573`*^9, 3.6993797302066193`*^9}, {
   3.699381022368298*^9, 3.699381045734913*^9}, {3.6993811154501677`*^9, 
   3.699381153312248*^9}, {3.69938120315177*^9, 3.69938120793635*^9}, {
   3.699381271368107*^9, 3.699381285148623*^9}, {3.6993815905996523`*^9, 
   3.6993816305506983`*^9}, {3.6993817352969427`*^9, 3.699381750959015*^9}, {
   3.699381817134328*^9, 3.699381827180809*^9}, {3.699381899867385*^9, 
   3.699381936443005*^9}, {3.699381991900078*^9, 3.69938199858084*^9}, {
   3.699382058051601*^9, 3.6993820608896646`*^9}, 3.699382149120675*^9, {
   3.6993822009877443`*^9, 3.699382207206746*^9}, {3.699408694006494*^9, 
   3.6994087037664623`*^9}, {3.699408744663302*^9, 3.699408773934369*^9}, {
   3.6994088852506523`*^9, 3.699408885710815*^9}, {3.699409080935945*^9, 
   3.6994091024323053`*^9}, {3.699409178173586*^9, 3.699409186166843*^9}, {
   3.699409255605386*^9, 3.699409261662022*^9}, {3.6994094013456*^9, 
   3.699409415384252*^9}, {3.6994094698738613`*^9, 3.6994094926228447`*^9}, {
   3.6994096876459503`*^9, 3.699409688586191*^9}, {3.699409747243548*^9, 
   3.699409748309638*^9}, {3.699438410404344*^9, 3.699438445144594*^9}, {
   3.699438502204834*^9, 3.699438504603657*^9}, {3.6994387453280067`*^9, 
   3.6994387535509357`*^9}, {3.699441699445137*^9, 3.699441770162627*^9}, {
   3.699441836123168*^9, 3.699441840009926*^9}, 3.6994421617780046`*^9, {
   3.699442213985821*^9, 3.6994423301194487`*^9}, 3.6994428209919357`*^9, {
   3.699443024400379*^9, 3.699443078029793*^9}, {3.699443116853113*^9, 
   3.699443125829698*^9}, {3.699443183811673*^9, 3.69944320526805*^9}, {
   3.699443416175631*^9, 3.699443418477928*^9}, {3.699443534044552*^9, 
   3.6994435358356953`*^9}, {3.6994435712112017`*^9, 3.699443573730384*^9}, {
   3.69944367448218*^9, 3.699443677319674*^9}, {3.699443718464497*^9, 
   3.699443720527499*^9}, 3.699618554944166*^9, {3.6996186051231937`*^9, 
   3.6996186217064543`*^9}, {3.6996186909069977`*^9, 3.699618704196063*^9}, {
   3.699618904112331*^9, 3.699618910984168*^9}, {3.699619204624504*^9, 
   3.699619222775876*^9}, {3.699619275471994*^9, 3.699619288494081*^9}, {
   3.6996196799187927`*^9, 3.6996196901815853`*^9}, {3.699619953489296*^9, 
   3.6996199922324257`*^9}, {3.6996200568201647`*^9, 3.699620061684183*^9}, {
   3.699620338792783*^9, 3.699620344910412*^9}, {3.699620379366787*^9, 
   3.699620397983265*^9}, {3.699620550177376*^9, 3.699620551611047*^9}, {
   3.699620590549999*^9, 3.699620598637076*^9}, {3.699621013162731*^9, 
   3.699621022779051*^9}, {3.69962178433744*^9, 3.6996217879923763`*^9}, {
   3.699622204830332*^9, 3.699622211486206*^9}, {3.699714716770771*^9, 
   3.699714722981455*^9}, {3.699787736291296*^9, 3.699787746952729*^9}, {
   3.6997943533598146`*^9, 3.699794355702626*^9}, {3.699794413170638*^9, 
   3.6997944203456163`*^9}, {3.699795172462195*^9, 3.699795174101433*^9}, {
   3.699795212027872*^9, 3.699795235891597*^9}, {3.699795274412263*^9, 
   3.699795422122322*^9}, {3.699796035697027*^9, 3.6997960460645847`*^9}, {
   3.6997961083722486`*^9, 3.699796119971027*^9}, {3.6997961929310093`*^9, 
   3.6997962022567577`*^9}, 3.699796244452837*^9, 3.699796394142158*^9, 
   3.6997974850434103`*^9, {3.699797612021317*^9, 3.699797615964066*^9}, {
   3.699797710298108*^9, 3.6997977119750023`*^9}, {3.699798946740747*^9, 
   3.699798957066622*^9}, {3.699799019430921*^9, 3.699799056622954*^9}, {
   3.699799086652554*^9, 3.699799089101726*^9}, 3.699799225383554*^9, 
   3.699799336394122*^9, 3.699799387951009*^9, {3.699802478916087*^9, 
   3.69980251319888*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Minumum at \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0.46920916462341494`", ",", "0.13760819833290694`"}], "}"}]}],
  SequenceForm["Minumum at ", {0.46920916462341494`, 0.13760819833290694`}],
  Editable->False]], "Print",
 CellChangeTimes->{3.699799093360263*^9, 3.699799267671612*^9, 
  3.699799339020022*^9, 3.699799411624674*^9, 3.699802557151585*^9, 
  3.699803272592987*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Contours: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "0.023429057902852064`", ",", "0.027179057902852063`", ",", 
     "0.03342905790285206`", ",", "0.04217905790285206`", ",", 
     "0.05342905790285206`", ",", "0.06717905790285206`", ",", 
     "0.08342905790285206`", ",", "0.10217905790285206`", ",", 
     "0.12342905790285207`", ",", "0.14717905790285207`"}], "}"}]}],
  SequenceForm[
  "Contours: ", {0.023429057902852064`, 0.027179057902852063`, 
   0.03342905790285206, 0.04217905790285206, 0.05342905790285206, 
   0.06717905790285206, 0.08342905790285206, 0.10217905790285206`, 
   0.12342905790285207`, 0.14717905790285207`}],
  Editable->False]], "Print",
 CellChangeTimes->{3.699799093360263*^9, 3.699799267671612*^9, 
  3.699799339020022*^9, 3.699799411624674*^9, 3.699802557151585*^9, 
  3.699803272595742*^9}],

Cell[BoxData["0.4159999999999999`"], "Print",
 CellChangeTimes->{3.699799093360263*^9, 3.699799267671612*^9, 
  3.699799339020022*^9, 3.699799411624674*^9, 3.699802557151585*^9, 
  3.699803272599918*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"CompiledFunction", "::", "cfn"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Numerical error encountered at instruction \
\[NoBreak]\\!\\(107\\)\[NoBreak]; proceeding with uncompiled evaluation. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/CompiledFunction/cfn\\\", ButtonNote -> \\\
\"CompiledFunction::cfn\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.699799093742326*^9, 3.699799269187408*^9, 
  3.6997993394185*^9, 3.699799421450775*^9, 3.699802562601376*^9, 
  3.6998032729832563`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Power", "::", "infy"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Infinite expression \[NoBreak]\\!\\(1\\/0.`\\)\[NoBreak] \
encountered. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/infy\\\", ButtonNote -> \
\\\"Power::infy\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.699799093742326*^9, 3.699799269187408*^9, 
  3.6997993394185*^9, 3.699799421450775*^9, 3.699802562601376*^9, 
  3.699803273013378*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Infinity", "::", "indet"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Indeterminate expression \[NoBreak]\\!\\(0.`\\\\ \
ComplexInfinity\\)\[NoBreak] encountered. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/indet\\\", ButtonNote -> \
\\\"Infinity::indet\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.699799093742326*^9, 3.699799269187408*^9, 
  3.6997993394185*^9, 3.699799421450775*^9, 3.699802562601376*^9, 
  3.699803273047271*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Power", "::", "infy"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Infinite expression \[NoBreak]\\!\\(1\\/0.`\\)\[NoBreak] \
encountered. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/infy\\\", ButtonNote -> \
\\\"Power::infy\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.699799093742326*^9, 3.699799269187408*^9, 
  3.6997993394185*^9, 3.699799421450775*^9, 3.699802562601376*^9, 
  3.6998032730743647`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Infinity", "::", "indet"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Indeterminate expression \[NoBreak]\\!\\(0.`\\\\ \
ComplexInfinity\\)\[NoBreak] encountered. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/indet\\\", ButtonNote -> \
\\\"Infinity::indet\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.699799093742326*^9, 3.699799269187408*^9, 
  3.6997993394185*^9, 3.699799421450775*^9, 3.699802562601376*^9, 
  3.6998032731026773`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Power", "::", "infy"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Infinite expression \[NoBreak]\\!\\(1\\/0.`\\)\[NoBreak] \
encountered. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/infy\\\", ButtonNote -> \
\\\"Power::infy\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.699799093742326*^9, 3.699799269187408*^9, 
  3.6997993394185*^9, 3.699799421450775*^9, 3.699802562601376*^9, 
  3.699803273134548*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Further output of \[NoBreak]\\!\\(\\*StyleBox[\\(Power :: \
infy\\), \\\"MessageName\\\"]\\)\[NoBreak] will be suppressed during this \
calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.699799093742326*^9, 3.699799269187408*^9, 
  3.6997993394185*^9, 3.699799421450775*^9, 3.699802562601376*^9, 
  3.699803273153844*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Infinity", "::", "indet"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Indeterminate expression \[NoBreak]\\!\\(0.`\\\\ \
ComplexInfinity\\)\[NoBreak] encountered. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/indet\\\", ButtonNote -> \
\\\"Infinity::indet\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.699799093742326*^9, 3.699799269187408*^9, 
  3.6997993394185*^9, 3.699799421450775*^9, 3.699802562601376*^9, 
  3.699803273181426*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Further output of \[NoBreak]\\!\\(\\*StyleBox[\\(Infinity \
:: indet\\), \\\"MessageName\\\"]\\)\[NoBreak] will be suppressed during this \
calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.699799093742326*^9, 3.699799269187408*^9, 
  3.6997993394185*^9, 3.699799421450775*^9, 3.699802562601376*^9, 
  3.6998032731989098`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"FindMinimum", "::", "nrnum"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"The function value \[NoBreak]\\!\\(Indeterminate\\)\
\[NoBreak] is not a real number at \[NoBreak]\\!\\({pL, pS}\\)\[NoBreak] = \
\[NoBreak]\\!\\({0.09999973608636974`, 0.`}\\)\[NoBreak]. \\!\\(\\*ButtonBox[\
\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/FindMinimum\\\", ButtonNote -> \
\\\"FindMinimum::nrnum\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.699799093742326*^9, 3.699799269187408*^9, 
  3.6997993394185*^9, 3.699799421450775*^9, 3.699802562601376*^9, 
  3.699803273294223*^9}]
}, Open  ]],

Cell["Use width 500 for presentation style", "Text",
 CellChangeTimes->{{3.699619119520092*^9, 3.699619129833075*^9}}],

Cell[BoxData[
 RowBox[{"Magnify", "[", 
  RowBox[{"plot1", ",", 
   RowBox[{"500", "/", "figureWidth"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6996216515809097`*^9, 3.6996216845371037`*^9}, {
  3.69962184005298*^9, 3.699621843066844*^9}, {3.699622051355081*^9, 
  3.69962205154571*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{"\"\<bkt-rss-fit.eps\>\"", ",", "plot1"}], "]"}]], "Input",
 CellChangeTimes->{{3.545415315763898*^9, 3.545415353126089*^9}, {
   3.552181423625525*^9, 3.5521814522066727`*^9}, 3.566591606034321*^9, {
   3.699380409614036*^9, 3.6993804433575497`*^9}, {3.69943870935252*^9, 
   3.699438711645583*^9}, {3.699442540997036*^9, 3.6994425411586103`*^9}, {
   3.699618951600685*^9, 3.699618952184157*^9}, 3.699621879107123*^9}],

Cell[BoxData["\<\"bkt-rss-fit.eps\"\>"], "Output",
 CellChangeTimes->{3.699618956298943*^9, 3.6996218830802393`*^9, 
  3.6997980128252087`*^9, 3.699799661794812*^9, 3.699802798592345*^9, 
  3.69980349697066*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{"\"\<bkt-rss-fit.pdf\>\"", ",", "plot1"}], "]"}]], "Input",
 CellChangeTimes->{{3.545415315763898*^9, 3.545415353126089*^9}, {
   3.552181423625525*^9, 3.5521814522066727`*^9}, 3.566591606034321*^9, {
   3.699380409614036*^9, 3.6993804433575497`*^9}, {3.69943870935252*^9, 
   3.699438711645583*^9}, {3.699442540997036*^9, 3.6994425411586103`*^9}, {
   3.699618951600685*^9, 3.699618952184157*^9}, 3.699621879107123*^9, {
   3.699813746839671*^9, 3.69981374852568*^9}}],

Cell[BoxData["\<\"bkt-rss-fit.pdf\"\>"], "Output",
 CellChangeTimes->{3.6998137506949377`*^9}]
}, Open  ]],

Cell["\<\
Now, do the same thing using maximum likelihood.  The contours should be \
s-standard-deviation region boundaries.\
\>", "Text",
 CellChangeTimes->{{3.695752213082271*^9, 3.6957522354448023`*^9}, {
  3.695839342604995*^9, 3.695839369986565*^9}, {3.695839405953393*^9, 
  3.695839447783347*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fitPoints", "=", "25"}], ",", 
     RowBox[{"students", "=", "100"}], ",", 
     RowBox[{"nContours", "=", "10"}], ",", "data", ",", "p0", ",", 
     RowBox[{"pL", "=", 
      RowBox[{"v1", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ",", "pG", ",", 
     RowBox[{"pS", "=", 
      RowBox[{"v1", "[", 
       RowBox[{"[", "4", "]"}], "]"}]}], ",", "aa", ",", "contours", ",", 
     "min", ",", "minPoint"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"data", "=", 
     RowBox[{"generateSequences", "[", 
      RowBox[{"v1", ",", "fitPoints", ",", "students"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Find", " ", "global", " ", "minimum"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", "=", 
        RowBox[{"FindMinimum", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"forwardAlgorithm", "[", 
             RowBox[{"vars", ",", "data", ",", "False"}], "]"}], ",", 
            RowBox[{"Element", "[", 
             RowBox[{"vars", ",", "markovChainRegion"}], "]"}]}], "}"}], ",", 
          
          RowBox[{"{", 
           RowBox[{"vars", ",", "v1"}], "}"}]}], "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"min", "=", 
        RowBox[{"x", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Minumum at \>\"", ",", 
         RowBox[{"minPoint", "=", 
          RowBox[{"x", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "1", ",", "2", ",", 
             RowBox[{"{", 
              RowBox[{"3", ",", "1"}], "}"}]}], "]"}], "]"}]}]}], "]"}]}]}], 
     "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"Specify", " ", "s"}], "-", "standard", "-", 
       RowBox[{"deviation", " ", 
        RowBox[{"contours", ".", " ", "\[IndentingNewLine]", "See"}], " ", 
        RowBox[{"Eqn", ".", " ", 
         RowBox[{"(", "38.13", ")"}]}], " ", "in", " ", 
        RowBox[{"http", ":"}]}]}], "//", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"pdg", ".", "lbl", ".", "gov"}], "/", "2014"}], "/", 
         "reviews"}], "/", "rpp2014"}], "-", "rev", "-", 
       RowBox[{"statistics", ".", "pdf"}]}]}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"contours", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"min", "+", 
        RowBox[{
         RowBox[{"s", "^", "2"}], "/", "2"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"s", ",", "1", ",", "nContours"}], "}"}]}], "]"}]}], ";", 
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Contours: \>\"", ",", "contours"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"aa", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "pS", "-", 
         RowBox[{"v1", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"v1", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"plot2", "=", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"ContourPlot", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{"False", " ", 
           RowBox[{"(*", " ", 
            RowBox[{
            "Choose", " ", "between", " ", "fixed", " ", "value", " ", "and", 
             " ", "fitting", " ", "for", " ", "pL", " ", "and", " ", 
             RowBox[{"pS", "."}]}], " ", "*)"}], ",", 
           RowBox[{"forwardAlgorithm", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"p0", ",", "pL", ",", "pG", ",", "pS"}], "}"}], ",", 
             "data", ",", "False"}], "]"}], ",", 
           RowBox[{"Block", "[", 
            RowBox[{
             RowBox[{"{", "x", "}"}], ",", 
             RowBox[{"(*", " ", 
              RowBox[{
               RowBox[{
               "Minimization", " ", "must", " ", "be", " ", "unconstrained"}],
                ",", " ", 
               RowBox[{
               "else", " ", "it", " ", "is", " ", "way", " ", "too", " ", 
                RowBox[{"slow", "."}]}]}], " ", "*)"}], 
             RowBox[{
              RowBox[{"x", "=", 
               RowBox[{"FindMinimum", "[", 
                RowBox[{
                 RowBox[{"forwardAlgorithm", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"p0", ",", "pL", ",", "pG", ",", "pS"}], "}"}], 
                   ",", "data", ",", "False"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"pL", ",", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"pS", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], "<", 
                    RowBox[{"1", "-", "pG"}]}], ",", 
                    RowBox[{"v1", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pG"}], ")"}], "/", "2"}]}], "]"}], ",",
                     "0", ",", 
                    RowBox[{"1", "-", "pG"}]}], "}"}]}], "}"}], ",", 
                 RowBox[{"MaxIterations", "\[Rule]", "100"}]}], "]"}]}], ";", 
              
              RowBox[{"x", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"pG", ",", "0", ",", "0.7"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"p0", ",", "0", ",", "0.7"}], "}"}], ",", 
         RowBox[{"MaxRecursion", "\[Rule]", "1"}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", "frameLabel"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"If", "[", 
           RowBox[{"True", ",", 
            RowBox[{"{", 
             RowBox[{"min", ",", 
              RowBox[{"contours", "[", 
               RowBox[{"[", 
                RowBox[{"-", "1"}], "]"}], "]"}]}], "}"}], ",", "Automatic"}],
            "]"}]}], ",", 
         RowBox[{"ColorFunction", "\[Rule]", "colorFunction"}], ",", 
         RowBox[{"Contours", "\[Rule]", "contours"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "figureWidth"}], ",", 
         RowBox[{"BaseStyle", "\[Rule]", "journalStyle"}], ",", 
         RowBox[{"Epilog", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"PointSize", "[", "Medium", "]"}], ",", 
            RowBox[{"Point", "[", 
             RowBox[{"v0", "[", 
              RowBox[{"[", 
               RowBox[{"{", 
                RowBox[{"3", ",", "1"}], "}"}], "]"}], "]"}], "]"}], ",", 
            RowBox[{"Point", "[", 
             RowBox[{"v1", "[", 
              RowBox[{"[", 
               RowBox[{"{", 
                RowBox[{"3", ",", "1"}], "}"}], "]"}], "]"}], "]"}], ",", 
            RowBox[{"Point", "[", 
             RowBox[{"v2", "[", 
              RowBox[{"[", 
               RowBox[{"{", 
                RowBox[{"3", ",", "1"}], "}"}], "]"}], "]"}], "]"}], ",", 
            RowBox[{"liner", "[", "minPoint", "]"}]}], "}"}]}]}], "]"}], ",", 
       
       RowBox[{"Plot", "[", 
        RowBox[{
         RowBox[{"1", "-", 
          RowBox[{"aa", "/", 
           RowBox[{"(", 
            RowBox[{"1", "-", "pS", "-", "pg"}], ")"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"pg", ",", "0", ",", 
           RowBox[{"1", "-", "pS", "-", "aa"}]}], "}"}]}], "]"}]}], 
      "]"}]}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.695684739642014*^9, 3.695684889339982*^9}, {
   3.695684942376011*^9, 3.695684962543622*^9}, {3.695685252775776*^9, 
   3.695685274519054*^9}, {3.695685343652039*^9, 3.6956853659533987`*^9}, {
   3.695685507132409*^9, 3.695685509794613*^9}, {3.695685568495496*^9, 
   3.695685587150949*^9}, {3.695685693018148*^9, 3.695685745358376*^9}, {
   3.695685796028145*^9, 3.6956857977797403`*^9}, {3.6956858340520267`*^9, 
   3.695685834338024*^9}, {3.695685887648785*^9, 3.695685888463688*^9}, {
   3.695686371463739*^9, 3.695686373398778*^9}, {3.695686433500022*^9, 
   3.6956864378515368`*^9}, {3.69569133577442*^9, 3.695691337076892*^9}, {
   3.6956917133622723`*^9, 3.695691737120656*^9}, {3.6956917761741*^9, 
   3.69569177954151*^9}, {3.695691849139596*^9, 3.695691853130497*^9}, {
   3.695691958693459*^9, 3.695691959076395*^9}, {3.695692144947198*^9, 
   3.6956921482349052`*^9}, {3.69569224755056*^9, 3.695692247774403*^9}, {
   3.6957306839163237`*^9, 3.695730759080119*^9}, {3.695730828666486*^9, 
   3.695730829523726*^9}, {3.6957309079152327`*^9, 3.6957309090312223`*^9}, 
   3.695730966467939*^9, {3.6957317444679937`*^9, 3.6957317568530083`*^9}, {
   3.695731956736779*^9, 3.695732078632155*^9}, {3.695732126590425*^9, 
   3.695732147404046*^9}, {3.6957321791791563`*^9, 3.695732277996274*^9}, {
   3.695732336089243*^9, 3.69573234568036*^9}, {3.6957324627046824`*^9, 
   3.695732468377056*^9}, {3.695732517358057*^9, 3.695732540229974*^9}, {
   3.695732575763887*^9, 3.6957326363195467`*^9}, {3.695732864561801*^9, 
   3.695732869929305*^9}, {3.695733031408703*^9, 3.69573309024516*^9}, {
   3.6957331420036383`*^9, 3.6957331427451353`*^9}, {3.695733319727084*^9, 
   3.695733322940084*^9}, {3.695733479421822*^9, 3.69573352140257*^9}, {
   3.695733576814838*^9, 3.695733577334581*^9}, {3.695734118929515*^9, 
   3.695734138820889*^9}, {3.6993797281447573`*^9, 3.6993797302066193`*^9}, {
   3.699381022368298*^9, 3.699381045734913*^9}, {3.6993811154501677`*^9, 
   3.699381153312248*^9}, {3.69938120315177*^9, 3.69938120793635*^9}, {
   3.699381271368107*^9, 3.699381285148623*^9}, {3.6993815905996523`*^9, 
   3.6993816305506983`*^9}, {3.6993817352969427`*^9, 3.699381750959015*^9}, {
   3.699381817134328*^9, 3.699381827180809*^9}, {3.699381899867385*^9, 
   3.699381936443005*^9}, {3.699381991900078*^9, 3.69938199858084*^9}, {
   3.699382058051601*^9, 3.6993820608896646`*^9}, 3.699382149120675*^9, {
   3.6993822009877443`*^9, 3.699382207206746*^9}, {3.699408694006494*^9, 
   3.6994087037664623`*^9}, {3.699408744663302*^9, 3.699408773934369*^9}, {
   3.6994088852506523`*^9, 3.699408885710815*^9}, {3.699409080935945*^9, 
   3.6994091024323053`*^9}, {3.699409178173586*^9, 3.699409186166843*^9}, {
   3.699409255605386*^9, 3.699409261662022*^9}, {3.6994094013456*^9, 
   3.699409415384252*^9}, {3.6994094698738613`*^9, 3.6994094926228447`*^9}, {
   3.6994096876459503`*^9, 3.699409688586191*^9}, {3.699409747243548*^9, 
   3.699409748309638*^9}, {3.699438410404344*^9, 3.699438445144594*^9}, {
   3.699438502204834*^9, 3.699438504603657*^9}, {3.6994387453280067`*^9, 
   3.6994387535509357`*^9}, {3.699441699445137*^9, 3.699441770162627*^9}, {
   3.699441836123168*^9, 3.699441840009926*^9}, 3.6994421617780046`*^9, {
   3.699442213985821*^9, 3.6994423301194487`*^9}, {3.699442611370322*^9, 
   3.699442620080055*^9}, {3.699442726510447*^9, 3.6994427630777473`*^9}, 
   3.69944279809342*^9, {3.6994429418741903`*^9, 3.699442942279842*^9}, {
   3.69944319664471*^9, 3.69944319923463*^9}, {3.6994432823535967`*^9, 
   3.699443285079988*^9}, {3.699443364169285*^9, 3.699443367319395*^9}, {
   3.699443693032454*^9, 3.699443705784917*^9}, {3.699621922940157*^9, 
   3.6996219928391953`*^9}, 3.6996220986923847`*^9, {3.699622142937582*^9, 
   3.699622160024837*^9}, 3.6997147351277637`*^9, {3.699796342360903*^9, 
   3.699796374863289*^9}, {3.699797660226122*^9, 3.699797663401699*^9}, {
   3.6997991775278873`*^9, 3.699799204455055*^9}, 3.6998025237361717`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"FindMinimum", "::", "eit"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"The algorithm does not converge to the tolerance of \
\[NoBreak]\\!\\(4.806217383937354`*^-6\\)\[NoBreak] in \[NoBreak]\\!\\(500\\)\
\[NoBreak] iterations. The best estimated solution, with feasibility \
residual, KKT residual, or complementary residual of \
\[NoBreak]\\!\\({9.615793798016022`*^-13, 0.000039527205749239263`, \
2.3453509282982546`*^-13}\\)\[NoBreak], is returned. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/FindMinimum\\\", ButtonNote -> \
\\\"FindMinimum::eit\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.699800659189034*^9, 3.699804426658716*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Minumum at \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0.3163462286531994`", ",", "0.3540794926031769`"}], "}"}]}],
  SequenceForm["Minumum at ", {0.3163462286531994, 0.3540794926031769}],
  Editable->False]], "Print",
 CellChangeTimes->{3.699800659253787*^9, 3.699804426717835*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Contours: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "883.7614582236306`", ",", "885.2614582236306`", ",", 
     "887.7614582236306`", ",", "891.2614582236306`", ",", 
     "895.7614582236306`", ",", "901.2614582236306`", ",", 
     "907.7614582236306`", ",", "915.2614582236306`", ",", 
     "923.7614582236306`", ",", "933.2614582236306`"}], "}"}]}],
  SequenceForm[
  "Contours: ", {883.7614582236306, 885.2614582236306, 887.7614582236306, 
   891.2614582236306, 895.7614582236306, 901.2614582236306, 907.7614582236306,
    915.2614582236306, 923.7614582236306, 933.2614582236306}],
  Editable->False]], "Print",
 CellChangeTimes->{3.699800659253787*^9, 3.69980442672116*^9}],

Cell[BoxData["0.4159999999999999`"], "Print",
 CellChangeTimes->{3.699800659253787*^9, 3.699804426727105*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"FindMinimum", "::", "lstol"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"The line search decreased the step size to within the \
tolerance specified by AccuracyGoal and PrecisionGoal but was unable to find \
a sufficient decrease in the function. You may need more than \
\[NoBreak]\\!\\(MachinePrecision\\)\[NoBreak] digits of working precision to \
meet these tolerances. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/FindMinimum/lstol\\\", ButtonNote -> \
\\\"FindMinimum::lstol\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.699800659189034*^9, 3.699804431417865*^9}]
}, Open  ]],

Cell["Use width 500 for presentation style", "Text",
 CellChangeTimes->{{3.699619119520092*^9, 3.699619129833075*^9}}],

Cell[BoxData[
 RowBox[{"Magnify", "[", 
  RowBox[{"plot2", ",", 
   RowBox[{"500", "/", "figureWidth"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6996216515809097`*^9, 3.6996216845371037`*^9}, {
  3.69962184005298*^9, 3.699621843066844*^9}, {3.699622027725333*^9, 
  3.6996220427588778`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{"\"\<bkt-ml-fit.eps\>\"", ",", "plot2"}], "]"}]], "Input",
 CellChangeTimes->{{3.545415315763898*^9, 3.545415353126089*^9}, {
   3.552181423625525*^9, 3.5521814522066727`*^9}, 3.566591606034321*^9, {
   3.699380409614036*^9, 3.6993804433575497`*^9}, {3.699380482510874*^9, 
   3.699380486355521*^9}, {3.699443656362699*^9, 3.699443656709773*^9}, 
   3.69962203593896*^9}],

Cell[BoxData["\<\"bkt-ml-fit.eps\"\>"], "Output",
 CellChangeTimes->{3.69980463822989*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{"\"\<bkt-ml-fit.pdf\>\"", ",", "plot2"}], "]"}]], "Input",
 CellChangeTimes->{{3.545415315763898*^9, 3.545415353126089*^9}, {
   3.552181423625525*^9, 3.5521814522066727`*^9}, 3.566591606034321*^9, {
   3.699380409614036*^9, 3.6993804433575497`*^9}, {3.699380482510874*^9, 
   3.699380486355521*^9}, {3.699443656362699*^9, 3.699443656709773*^9}, 
   3.69962203593896*^9, {3.6998137643599663`*^9, 3.6998137657247953`*^9}}],

Cell[BoxData["\<\"bkt-ml-fit.pdf\"\>"], "Output",
 CellChangeTimes->{3.699813767114601*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Save", "[", 
  RowBox[{"\"\<bkt-countours.m\>\"", ",", 
   RowBox[{"{", 
    RowBox[{"plot1", ",", "plot2"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.699622112641615*^9, 3.6996221305110188`*^9}}],

Cell["\<\
Plot an example learning curve with the student-averaged synthetic data and \
the associated Markov chain solution.\
\>", "Text",
 CellChangeTimes->{{3.696000792507184*^9, 3.69600084991306*^9}}],

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"n", "=", "25"}], ",", 
     RowBox[{"m", "=", "100"}]}], "}"}], ",", 
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{"ListPlot", "[", 
      RowBox[{
       RowBox[{"Map", "[", 
        RowBox[{"Mean", ",", 
         RowBox[{"Transpose", "[", 
          RowBox[{"generateSequences", "[", 
           RowBox[{"v1", ",", "n", ",", "m"}], "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}]}], ",", 
       RowBox[{"Axes", "\[Rule]", "False"}], ",", 
       RowBox[{"Frame", "\[Rule]", "True"}], ",", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<step\>\"", ",", "\"\<probability of correct\>\""}], 
         "}"}]}]}], "]"}], ",", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{"markovChain", "[", 
        RowBox[{"v1", ",", "x"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "1", ",", "n"}], "}"}]}], "]"}]}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.695661023038734*^9, 3.695661039295741*^9}, {
   3.6956610790876503`*^9, 3.69566116395584*^9}, {3.695661200723075*^9, 
   3.69566120536303*^9}, {3.695663353256716*^9, 3.6956633857929287`*^9}, {
   3.695663424181943*^9, 3.695663636535295*^9}, {3.6956636804310627`*^9, 
   3.695663680685864*^9}, 3.695730552085747*^9, {3.695731730178421*^9, 
   3.695731731053788*^9}, {3.695732755352935*^9, 3.695732756542749*^9}, {
   3.6996221728367453`*^9, 3.699622181588018*^9}, {3.6996222227879763`*^9, 
   3.6996222325313673`*^9}}]
}, Open  ]]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{749, 758},
WindowMargins->{{Automatic, 67}, {34, Automatic}},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> False}},
ShowSelection->True,
FrontEndVersion->"10.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (December 4, \
2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[545, 20, 264, 5, 49, "Text"],
Cell[CellGroupData[{
Cell[834, 29, 197, 4, 28, "Input",
 InitializationCell->True],
Cell[1034, 35, 527, 8, 28, "Output"]
}, Open  ]],
Cell[1576, 46, 1567, 38, 97, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[3168, 88, 355, 5, 44, "Subsection"],
Cell[3526, 95, 3871, 99, 131, "Input"],
Cell[CellGroupData[{
Cell[7422, 198, 359, 7, 28, "Input"],
Cell[7784, 207, 357, 5, 28, "Output"]
}, Open  ]],
Cell[8156, 215, 138, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[8319, 220, 508, 14, 28, "Input"],
Cell[8830, 236, 114, 1, 28, "Output"]
}, Open  ]],
Cell[8959, 240, 4517, 109, 131, "Input"],
Cell[CellGroupData[{
Cell[13501, 353, 404, 8, 28, "Input"],
Cell[13908, 363, 333, 4, 28, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[14290, 373, 264, 3, 36, "Subsection"],
Cell[14557, 378, 143, 1, 30, "Text"],
Cell[14703, 381, 489, 12, 28, "Input",
 InitializationCell->True],
Cell[15195, 395, 1372, 41, 63, "Input",
 InitializationCell->True],
Cell[16570, 438, 115, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[16710, 443, 478, 11, 28, "Input",
 InitializationCell->True],
Cell[17191, 456, 747, 18, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17975, 479, 126, 2, 28, "Input"],
Cell[18104, 483, 320, 9, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18461, 497, 483, 11, 28, "Input",
 InitializationCell->True],
Cell[18947, 510, 807, 20, 70, "Output"]
}, Open  ]],
Cell[19769, 533, 110, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[19904, 538, 429, 10, 28, "Input"],
Cell[20336, 550, 860, 26, 50, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21233, 581, 666, 17, 46, "Input"],
Cell[21902, 600, 2244, 64, 104, "Output"]
}, Open  ]],
Cell[24161, 667, 827, 27, 87, "Text"],
Cell[24991, 696, 4179, 106, 216, "Input"],
Cell[CellGroupData[{
Cell[29195, 806, 462, 9, 28, "Input"],
Cell[29660, 817, 315, 4, 28, "Output"]
}, Open  ]],
Cell[29990, 824, 208, 4, 49, "Text"],
Cell[30201, 830, 3537, 82, 131, "Input"],
Cell[33741, 914, 326, 6, 30, "Text"],
Cell[CellGroupData[{
Cell[34092, 924, 1088, 18, 46, "Input"],
Cell[35183, 944, 742, 11, 28, "Output"]
}, Open  ]],
Cell[35940, 958, 368, 7, 49, "Text"],
Cell[36311, 967, 5108, 129, 267, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[41456, 1101, 219, 3, 36, "Subsection"],
Cell[41678, 1106, 268, 5, 49, "Text"],
Cell[CellGroupData[{
Cell[41971, 1115, 95, 1, 35, "Subsubsection"],
Cell[42069, 1118, 2527, 66, 131, "Input",
 InitializationCell->True],
Cell[44599, 1186, 700, 21, 46, "Input",
 InitializationCell->True],
Cell[45302, 1209, 15588, 331, 778, "Input",
 InitializationCell->True],
Cell[60893, 1542, 618, 16, 63, "Input",
 InitializationCell->True],
Cell[61514, 1560, 1066, 27, 80, "Input",
 InitializationCell->True],
Cell[62583, 1589, 2196, 64, 114, "Input",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[64816, 1658, 101, 1, 29, "Subsubsection"],
Cell[64920, 1661, 97, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[65042, 1666, 1266, 32, 97, "Input"],
Cell[66311, 1700, 528, 13, 28, "Output"]
}, Open  ]],
Cell[66854, 1716, 128, 2, 28, "Input"],
Cell[66985, 1720, 111, 1, 30, "Text"],
Cell[67099, 1723, 1602, 42, 80, "Input"],
Cell[68704, 1767, 792, 15, 182, "Text"],
Cell[CellGroupData[{
Cell[69521, 1786, 14039, 292, 607, "Input"],
Cell[CellGroupData[{
Cell[83585, 2082, 446, 9, 21, "Print"],
Cell[84034, 2093, 895, 18, 37, "Print"],
Cell[84932, 2113, 203, 3, 21, "Print"]
}, Open  ]],
Cell[85150, 2119, 639, 13, 24, "Message"],
Cell[85792, 2134, 561, 12, 40, "Message"],
Cell[86356, 2148, 591, 12, 24, "Message"],
Cell[86950, 2162, 563, 12, 40, "Message"],
Cell[87516, 2176, 593, 12, 24, "Message"],
Cell[88112, 2190, 561, 12, 40, "Message"],
Cell[88676, 2204, 642, 13, 24, "Message"],
Cell[89321, 2219, 591, 12, 24, "Message"],
Cell[89915, 2233, 648, 13, 24, "Message"],
Cell[90566, 2248, 682, 13, 24, "Message"]
}, Open  ]],
Cell[91263, 2264, 118, 1, 30, "Text"],
Cell[91384, 2267, 289, 6, 28, "Input"],
Cell[CellGroupData[{
Cell[91698, 2277, 469, 7, 28, "Input"],
Cell[92170, 2286, 211, 3, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[92418, 2294, 518, 8, 28, "Input"],
Cell[92939, 2304, 94, 1, 28, "Output"]
}, Open  ]],
Cell[93048, 2308, 304, 6, 49, "Text"],
Cell[CellGroupData[{
Cell[93377, 2318, 11961, 257, 556, "Input"],
Cell[105341, 2577, 780, 14, 81, "Message"],
Cell[CellGroupData[{
Cell[106146, 2595, 346, 7, 21, "Print"],
Cell[106495, 2604, 747, 15, 37, "Print"],
Cell[107245, 2621, 109, 1, 21, "Print"]
}, Open  ]],
Cell[107369, 2625, 717, 13, 75, "Message"]
}, Open  ]],
Cell[108101, 2641, 118, 1, 30, "Text"],
Cell[108222, 2644, 292, 6, 28, "Input"],
Cell[CellGroupData[{
Cell[108539, 2654, 420, 7, 28, "Input"],
Cell[108962, 2663, 90, 1, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[109089, 2669, 470, 7, 28, "Input"],
Cell[109562, 2678, 91, 1, 28, "Output"]
}, Open  ]],
Cell[109668, 2682, 227, 5, 28, "Input"],
Cell[109898, 2689, 204, 4, 49, "Text"],
Cell[110105, 2695, 1621, 39, 97, "Input"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
